<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>modules.machinery.virtualbox</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="modules-module.html">Package&nbsp;modules</a> ::
        <a href="modules.machinery-module.html">Package&nbsp;machinery</a> ::
        Module&nbsp;virtualbox
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="modules.machinery.virtualbox-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="modules.machinery.virtualbox-module.html">Module modules.machinery.virtualbox</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2010-2013 Claudio Guarnieri.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2014-2016 Cuckoo Foundation.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">re</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">subprocess</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.abstracts=lib.cuckoo.common.abstracts-module.html"><a title="lib.cuckoo.common.abstracts" class="py-name" href="#" onclick="return doclink('link-3', 'abstracts', 'link-3');">abstracts</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Class lib.cuckoo.common.abstracts.Machinery=lib.cuckoo.common.abstracts.Machinery-class.html"><a title="lib.cuckoo.common.abstracts.Machinery" class="py-name" href="#" onclick="return doclink('link-4', 'Machinery', 'link-4');">Machinery</a></tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-5', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-6" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-6', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-7', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-8', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooCriticalError=lib.cuckoo.common.exceptions.CuckooCriticalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-9', 'CuckooCriticalError', 'link-9');">CuckooCriticalError</a></tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-10', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-11', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-12', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-13', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooMachineError=lib.cuckoo.common.exceptions.CuckooMachineError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-14', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt id="link-15" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.common.utils.log=lib.cuckoo.common.utils-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Module lib.cuckoo.core.log=lib.cuckoo.core.log-module.html,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.reboot.log=modules.auxiliary.reboot-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.debug.log=modules.processing.debug-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.irma.log=modules.processing.irma-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.misp.log=modules.processing.misp-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.procmemory.log=modules.processing.procmemory-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.elasticsearch.log=modules.reporting.elasticsearch-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-15', 'log', 'link-15');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox"></a><div id="VirtualBox-def"><a name="L19"></a><tt class="py-lineno"> 19</tt> <a class="py-toggle" href="#" id="VirtualBox-toggle" onclick="return toggle('VirtualBox');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html">VirtualBox</a><tt class="py-op">(</tt><tt class="py-base-class">Machinery</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="VirtualBox-expanded"><a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line">    <tt class="py-docstring">"""Virtualization layer for VirtualBox."""</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line">    <tt class="py-comment"># VM states.</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line">    <tt id="link-16" class="py-name" targets="Variable modules.machinery.virtualbox.VirtualBox.SAVED=modules.machinery.virtualbox.VirtualBox-class.html#SAVED"><a title="modules.machinery.virtualbox.VirtualBox.SAVED" class="py-name" href="#" onclick="return doclink('link-16', 'SAVED', 'link-16');">SAVED</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"saved"</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line">    <tt id="link-17" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#RUNNING,Variable modules.machinery.physical.Physical.RUNNING=modules.machinery.physical.Physical-class.html#RUNNING,Variable modules.machinery.qemu.QEMU.RUNNING=modules.machinery.qemu.QEMU-class.html#RUNNING,Variable modules.machinery.virtualbox.VirtualBox.RUNNING=modules.machinery.virtualbox.VirtualBox-class.html#RUNNING,Variable modules.machinery.vsphere.vSphere.RUNNING=modules.machinery.vsphere.vSphere-class.html#RUNNING,Variable modules.machinery.xenserver.XenServerMachinery.RUNNING=modules.machinery.xenserver.XenServerMachinery-class.html#RUNNING"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-17', 'RUNNING', 'link-17');">RUNNING</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"running"</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line">    <tt id="link-18" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#POWEROFF,Variable modules.machinery.virtualbox.VirtualBox.POWEROFF=modules.machinery.virtualbox.VirtualBox-class.html#POWEROFF,Variable modules.machinery.vsphere.vSphere.POWEROFF=modules.machinery.vsphere.vSphere-class.html#POWEROFF,Variable modules.machinery.xenserver.XenServerMachinery.POWEROFF=modules.machinery.xenserver.XenServerMachinery-class.html#POWEROFF"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF
modules.machinery.virtualbox.VirtualBox.POWEROFF
modules.machinery.vsphere.vSphere.POWEROFF
modules.machinery.xenserver.XenServerMachinery.POWEROFF" class="py-name" href="#" onclick="return doclink('link-18', 'POWEROFF', 'link-18');">POWEROFF</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"poweroff"</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line">    <tt id="link-19" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#ABORTED,Variable modules.machinery.virtualbox.VirtualBox.ABORTED=modules.machinery.virtualbox.VirtualBox-class.html#ABORTED,Variable modules.machinery.vsphere.vSphere.ABORTED=modules.machinery.vsphere.vSphere-class.html#ABORTED,Variable modules.machinery.xenserver.XenServerMachinery.ABORTED=modules.machinery.xenserver.XenServerMachinery-class.html#ABORTED"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED
modules.machinery.virtualbox.VirtualBox.ABORTED
modules.machinery.vsphere.vSphere.ABORTED
modules.machinery.xenserver.XenServerMachinery.ABORTED" class="py-name" href="#" onclick="return doclink('link-19', 'ABORTED', 'link-19');">ABORTED</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"aborted"</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line">    <tt id="link-20" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#ERROR,Variable modules.machinery.physical.Physical.ERROR=modules.machinery.physical.Physical-class.html#ERROR,Variable modules.machinery.qemu.QEMU.ERROR=modules.machinery.qemu.QEMU-class.html#ERROR,Variable modules.machinery.virtualbox.VirtualBox.ERROR=modules.machinery.virtualbox.VirtualBox-class.html#ERROR"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-20', 'ERROR', 'link-20');">ERROR</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"machete"</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox._initialize_check"></a><div id="VirtualBox._initialize_check-def"><a name="L29"></a><tt class="py-lineno"> 29</tt> <a class="py-toggle" href="#" id="VirtualBox._initialize_check-toggle" onclick="return toggle('VirtualBox._initialize_check');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#_initialize_check">_initialize_check</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox._initialize_check-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox._initialize_check-expanded"><a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line">        <tt class="py-docstring">"""Runs all checks when a machine manager is initialized.</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if VBoxManage is not found.</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line">        <tt class="py-comment"># VirtualBox specific checks.</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-21" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Method lib.cuckoo.core.database.Task.options()=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-21', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name" targets="Module modules.machinery.virtualbox=modules.machinery.virtualbox-module.html"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-22', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">:</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-23" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-23', 'CuckooCriticalError', 'link-9');">CuckooCriticalError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VirtualBox VBoxManage path missing, "</tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">                                      <tt class="py-string">"please add it to the config file"</tt><tt class="py-op">)</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-24" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-24', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-25', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-26" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-26', 'CuckooCriticalError', 'link-9');">CuckooCriticalError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VirtualBox VBoxManage not found at "</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line">                                      <tt class="py-string">"specified path \"%s\""</tt> <tt class="py-op">%</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line">                                      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-27" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-27', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-28', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">        <tt class="py-comment"># Base checks.</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">        <tt class="py-name">super</tt><tt class="py-op">(</tt><tt id="link-29" class="py-name" targets="Class modules.machinery.virtualbox.VirtualBox=modules.machinery.virtualbox.VirtualBox-class.html"><a title="modules.machinery.virtualbox.VirtualBox" class="py-name" href="#" onclick="return doclink('link-29', 'VirtualBox', 'link-29');">VirtualBox</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-30" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery._initialize_check()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#_initialize_check,Method lib.cuckoo.common.abstracts.Machinery._initialize_check()=lib.cuckoo.common.abstracts.Machinery-class.html#_initialize_check,Method modules.machinery.avd.Avd._initialize_check()=modules.machinery.avd.Avd-class.html#_initialize_check,Method modules.machinery.esx.ESX._initialize_check()=modules.machinery.esx.ESX-class.html#_initialize_check,Method modules.machinery.physical.Physical._initialize_check()=modules.machinery.physical.Physical-class.html#_initialize_check,Method modules.machinery.qemu.QEMU._initialize_check()=modules.machinery.qemu.QEMU-class.html#_initialize_check,Method modules.machinery.virtualbox.VirtualBox._initialize_check()=modules.machinery.virtualbox.VirtualBox-class.html#_initialize_check,Method modules.machinery.vmware.VMware._initialize_check()=modules.machinery.vmware.VMware-class.html#_initialize_check,Method modules.machinery.vsphere.vSphere._initialize_check()=modules.machinery.vsphere.vSphere-class.html#_initialize_check,Method modules.machinery.xenserver.XenServerMachinery._initialize_check()=modules.machinery.xenserver.XenServerMachinery-class.html#_initialize_check"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._initialize_check
lib.cuckoo.common.abstracts.Machinery._initialize_check
modules.machinery.avd.Avd._initialize_check
modules.machinery.esx.ESX._initialize_check
modules.machinery.physical.Physical._initialize_check
modules.machinery.qemu.QEMU._initialize_check
modules.machinery.virtualbox.VirtualBox._initialize_check
modules.machinery.vmware.VMware._initialize_check
modules.machinery.vsphere.vSphere._initialize_check
modules.machinery.xenserver.XenServerMachinery._initialize_check" class="py-name" href="#" onclick="return doclink('link-30', '_initialize_check', 'link-30');">_initialize_check</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox.start"></a><div id="VirtualBox.start-def"><a name="L45"></a><tt class="py-lineno"> 45</tt> <a class="py-toggle" href="#" id="VirtualBox.start-toggle" onclick="return toggle('VirtualBox.start');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#start">start</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox.start-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox.start-expanded"><a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start a virtual machine.</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: virtual machine name.</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-docstring">        @param task: task object.</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to start.</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">        <tt id="link-31" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-31', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Module modules.processing.debug=modules.processing.debug-module.html"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-32', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Starting vm %s"</tt> <tt class="py-op">%</tt> <tt id="link-33" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.label=lib.cuckoo.core.database.Guest-class.html#label,Variable lib.cuckoo.core.database.Machine.label=lib.cuckoo.core.database.Machine-class.html#label"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-33', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-34" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery._status()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#_status,Method modules.machinery.avd.Avd._status()=modules.machinery.avd.Avd-class.html#_status,Method modules.machinery.physical.Physical._status()=modules.machinery.physical.Physical-class.html#_status,Method modules.machinery.qemu.QEMU._status()=modules.machinery.qemu.QEMU-class.html#_status,Method modules.machinery.virtualbox.VirtualBox._status()=modules.machinery.virtualbox.VirtualBox-class.html#_status,Method modules.machinery.vsphere.vSphere._status()=modules.machinery.vsphere.vSphere-class.html#_status,Method modules.machinery.xenserver.XenServerMachinery._status()=modules.machinery.xenserver.XenServerMachinery-class.html#_status"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-34', '_status', 'link-34');">_status</a></tt><tt class="py-op">(</tt><tt id="link-35" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-35', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-36" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-36', 'RUNNING', 'link-17');">RUNNING</a></tt><tt class="py-op">:</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-37" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-37', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Trying to start an already "</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">                                     <tt class="py-string">"started vm %s"</tt> <tt class="py-op">%</tt> <tt id="link-38" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-38', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">        <tt id="link-39" class="py-name" targets="Variable lib.cuckoo.core.database.Task.machine=lib.cuckoo.core.database.Task-class.html#machine"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-39', 'machine', 'link-39');">machine</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-40" class="py-name" targets="Variable lib.cuckoo.core.guest.db=lib.cuckoo.core.guest-module.html#db,Variable modules.auxiliary.services.db=modules.auxiliary.services-module.html#db"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-40', 'db', 'link-40');">db</a></tt><tt class="py-op">.</tt><tt id="link-41" class="py-name" targets="Method lib.cuckoo.core.database.Database.view_machine_by_label()=lib.cuckoo.core.database.Database-class.html#view_machine_by_label"><a title="lib.cuckoo.core.database.Database.view_machine_by_label" class="py-name" href="#" onclick="return doclink('link-41', 'view_machine_by_label', 'link-41');">view_machine_by_label</a></tt><tt class="py-op">(</tt><tt id="link-42" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-42', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">        <tt class="py-name">virtualbox_args</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-43" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-43', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-44" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-44', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-string">"snapshot"</tt><tt class="py-op">,</tt> <tt id="link-45" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-45', 'label', 'link-33');">label</a></tt><tt class="py-op">]</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-46" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-46', 'machine', 'link-39');">machine</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.snapshot=lib.cuckoo.core.database.Machine-class.html#snapshot"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-47', 'snapshot', 'link-47');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">            <tt id="link-48" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-48', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-49', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Using snapshot {0} for virtual machine "</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">                      <tt class="py-string">"{1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-50" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-50', 'machine', 'link-39');">machine</a></tt><tt class="py-op">.</tt><tt id="link-51" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-51', 'snapshot', 'link-47');">snapshot</a></tt><tt class="py-op">,</tt> <tt id="link-52" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-52', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">            <tt class="py-name">virtualbox_args</tt><tt class="py-op">.</tt><tt class="py-name">extend</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"restore"</tt><tt class="py-op">,</tt> <tt id="link-53" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-53', 'machine', 'link-39');">machine</a></tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-54', 'snapshot', 'link-47');">snapshot</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">            <tt id="link-55" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-55', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-56', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Using current snapshot for virtual machine "</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">                      <tt class="py-string">"{0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-57" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-57', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">            <tt class="py-name">virtualbox_args</tt><tt class="py-op">.</tt><tt class="py-name">extend</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">"restorecurrent"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">call</tt><tt class="py-op">(</tt><tt class="py-name">virtualbox_args</tt><tt class="py-op">,</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">                               <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">                               <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">                               <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-58" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-58', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage exited with error "</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">                                         <tt class="py-string">"restoring the machine's snapshot"</tt><tt class="py-op">)</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-59" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-59', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed restoring the "</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">                                     <tt class="py-string">"machine: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-60" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery._wait_status()=lib.cuckoo.common.abstracts.Machinery-class.html#_wait_status"><a title="lib.cuckoo.common.abstracts.Machinery._wait_status" class="py-name" href="#" onclick="return doclink('link-60', '_wait_status', 'link-60');">_wait_status</a></tt><tt class="py-op">(</tt><tt id="link-61" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-61', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-62" class="py-name"><a title="modules.machinery.virtualbox.VirtualBox.SAVED" class="py-name" href="#" onclick="return doclink('link-62', 'SAVED', 'link-16');">SAVED</a></tt><tt class="py-op">)</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">            <tt class="py-name">proc</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">Popen</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-63" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-63', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-64" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-64', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">                                     <tt class="py-string">"startvm"</tt><tt class="py-op">,</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">                                     <tt id="link-65" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-65', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">                                     <tt class="py-string">"--type"</tt><tt class="py-op">,</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">                                     <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-66', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-67', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">mode</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">                                    <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">                                    <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">                                    <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">            <tt class="py-name">output</tt><tt class="py-op">,</tt> <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">communicate</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">err</tt><tt class="py-op">:</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt class="py-name">OSError</tt><tt class="py-op">(</tt><tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-68" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-68', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed starting the machine "</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">                                     <tt class="py-string">"in %s mode: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">                                     <tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-69" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-69', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-70', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">mode</tt><tt class="py-op">.</tt><tt class="py-name">upper</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line"> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-71" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery._wait_status" class="py-name" href="#" onclick="return doclink('link-71', '_wait_status', 'link-60');">_wait_status</a></tt><tt class="py-op">(</tt><tt id="link-72" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-72', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-73" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-73', 'RUNNING', 'link-17');">RUNNING</a></tt><tt class="py-op">)</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">        <tt class="py-comment"># Handle network dumping through the internal VirtualBox functionality.</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">"nictrace"</tt> <tt class="py-keyword">in</tt> <tt id="link-74" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-74', 'machine', 'link-39');">machine</a></tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-75', 'options', 'link-21');">options</a></tt><tt class="py-op">:</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-76" class="py-name" targets="Method modules.machinery.virtualbox.VirtualBox.dump_pcap()=modules.machinery.virtualbox.VirtualBox-class.html#dump_pcap"><a title="modules.machinery.virtualbox.VirtualBox.dump_pcap" class="py-name" href="#" onclick="return doclink('link-76', 'dump_pcap', 'link-76');">dump_pcap</a></tt><tt class="py-op">(</tt><tt id="link-77" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-77', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">task</tt><tt class="py-op">)</tt> </tt>
</div><a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox.dump_pcap"></a><div id="VirtualBox.dump_pcap-def"><a name="L104"></a><tt class="py-lineno">104</tt> <a class="py-toggle" href="#" id="VirtualBox.dump_pcap-toggle" onclick="return toggle('VirtualBox.dump_pcap');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#dump_pcap">dump_pcap</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox.dump_pcap-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox.dump_pcap-expanded"><a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">        <tt class="py-docstring">"""Dump the pcap for this analysis through the VirtualBox integrated</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line"><tt class="py-docstring">        nictrace functionality. This is useful in scenarios where multiple</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"><tt class="py-docstring">        Virtual Machines are talking with each other in the same subnet (which</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line"><tt class="py-docstring">        you normally don't see when tcpdump'ing on the gatway)."""</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">            <tt class="py-name">args</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-78" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-78', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-79" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-79', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                <tt class="py-string">"controlvm"</tt><tt class="py-op">,</tt> <tt id="link-80" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-80', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">                <tt class="py-string">"nictracefile1"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-81" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.pcap_path()=lib.cuckoo.common.abstracts.Machinery-class.html#pcap_path"><a title="lib.cuckoo.common.abstracts.Machinery.pcap_path" class="py-name" href="#" onclick="return doclink('link-81', 'pcap_path', 'link-81');">pcap_path</a></tt><tt class="py-op">(</tt><tt class="py-name">task</tt><tt class="py-op">.</tt><tt id="link-82" class="py-name" targets="Variable lib.cuckoo.core.database.Error.id=lib.cuckoo.core.database.Error-class.html#id,Variable lib.cuckoo.core.database.Guest.id=lib.cuckoo.core.database.Guest-class.html#id,Variable lib.cuckoo.core.database.Machine.id=lib.cuckoo.core.database.Machine-class.html#id,Variable lib.cuckoo.core.database.Sample.id=lib.cuckoo.core.database.Sample-class.html#id,Variable lib.cuckoo.core.database.Tag.id=lib.cuckoo.core.database.Tag-class.html#id,Variable lib.cuckoo.core.database.Task.id=lib.cuckoo.core.database.Task-class.html#id"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-82', 'id', 'link-82');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">            <tt class="py-op">]</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">            <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">check_call</tt><tt class="py-op">(</tt><tt class="py-name">args</tt><tt class="py-op">)</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">CalledProcessError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">            <tt id="link-83" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-83', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">critical</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to set NIC tracefile (pcap file): %s"</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">            <tt class="py-name">args</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-84" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-84', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-85" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-85', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">                <tt class="py-string">"controlvm"</tt><tt class="py-op">,</tt> <tt id="link-86" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-86', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                <tt class="py-string">"nictrace1"</tt><tt class="py-op">,</tt> <tt class="py-string">"on"</tt><tt class="py-op">,</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">            <tt class="py-op">]</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">            <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">check_call</tt><tt class="py-op">(</tt><tt class="py-name">args</tt><tt class="py-op">)</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">CalledProcessError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">            <tt id="link-87" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-87', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">critical</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to enable NIC tracing (pcap file): %s"</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
</div><a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox.stop"></a><div id="VirtualBox.stop-def"><a name="L131"></a><tt class="py-lineno">131</tt> <a class="py-toggle" href="#" id="VirtualBox.stop-toggle" onclick="return toggle('VirtualBox.stop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#stop">stop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox.stop-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox.stop-expanded"><a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">        <tt class="py-docstring">"""Stops a virtual machine.</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: virtual machine name.</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to stop.</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">        <tt id="link-88" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-88', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-89" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-89', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Stopping vm %s"</tt> <tt class="py-op">%</tt> <tt id="link-90" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-90', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line"> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-91', '_status', 'link-34');">_status</a></tt><tt class="py-op">(</tt><tt id="link-92" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-92', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-93" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF
modules.machinery.virtualbox.VirtualBox.POWEROFF
modules.machinery.vsphere.vSphere.POWEROFF
modules.machinery.xenserver.XenServerMachinery.POWEROFF" class="py-name" href="#" onclick="return doclink('link-93', 'POWEROFF', 'link-18');">POWEROFF</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-94" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED
modules.machinery.virtualbox.VirtualBox.ABORTED
modules.machinery.vsphere.vSphere.ABORTED
modules.machinery.xenserver.XenServerMachinery.ABORTED" class="py-name" href="#" onclick="return doclink('link-94', 'ABORTED', 'link-19');">ABORTED</a></tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-95" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-95', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Trying to stop an already stopped "</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">                                     <tt class="py-string">"vm %s"</tt> <tt class="py-op">%</tt> <tt id="link-96" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-96', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">            <tt class="py-name">proc</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">Popen</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-97" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-97', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-98', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">                                     <tt class="py-string">"controlvm"</tt><tt class="py-op">,</tt> <tt id="link-99" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-99', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-string">"poweroff"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">                                    <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">                                    <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">                                    <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">            <tt class="py-comment"># Sometimes VBoxManage stucks when stopping vm so we needed</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">            <tt class="py-comment"># to add a timeout and kill it after that.</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">            <tt class="py-name">stop_me</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">            <tt class="py-keyword">while</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">poll</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">stop_me</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">options_globals</tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt class="py-name">vm_state</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">                    <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">                    <tt class="py-name">stop_me</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">                    <tt id="link-100" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-100', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-101', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Stopping vm %s timeouted. Killing"</tt> <tt class="py-op">%</tt> <tt id="link-102" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-102', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">                    <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">terminate</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line"> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">returncode</tt> <tt class="py-op">!=</tt> <tt class="py-number">0</tt> <tt class="py-keyword">and</tt> \ </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">                    <tt class="py-name">stop_me</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">options_globals</tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt class="py-name">vm_state</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">                <tt id="link-103" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-103', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-104" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-104', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage exited with error "</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">                          <tt class="py-string">"powering off the machine"</tt><tt class="py-op">)</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-105" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-105', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed powering off the "</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">                                     <tt class="py-string">"machine: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-106" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery._wait_status" class="py-name" href="#" onclick="return doclink('link-106', '_wait_status', 'link-60');">_wait_status</a></tt><tt class="py-op">(</tt><tt id="link-107" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-107', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-108" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF
modules.machinery.virtualbox.VirtualBox.POWEROFF
modules.machinery.vsphere.vSphere.POWEROFF
modules.machinery.xenserver.XenServerMachinery.POWEROFF" class="py-name" href="#" onclick="return doclink('link-108', 'POWEROFF', 'link-18');">POWEROFF</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-109" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED
modules.machinery.virtualbox.VirtualBox.ABORTED
modules.machinery.vsphere.vSphere.ABORTED
modules.machinery.xenserver.XenServerMachinery.ABORTED" class="py-name" href="#" onclick="return doclink('link-109', 'ABORTED', 'link-19');">ABORTED</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-110" class="py-name"><a title="modules.machinery.virtualbox.VirtualBox.SAVED" class="py-name" href="#" onclick="return doclink('link-110', 'SAVED', 'link-16');">SAVED</a></tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox._list"></a><div id="VirtualBox._list-def"><a name="L168"></a><tt class="py-lineno">168</tt> <a class="py-toggle" href="#" id="VirtualBox._list-toggle" onclick="return toggle('VirtualBox._list');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#_list">_list</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox._list-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox._list-expanded"><a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">        <tt class="py-docstring">"""Lists virtual machines installed.</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line"><tt class="py-docstring">        @return: virtual machine names list.</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">            <tt class="py-name">proc</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">Popen</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-111" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-111', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-112" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-112', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">                                     <tt class="py-string">"list"</tt><tt class="py-op">,</tt> <tt class="py-string">"vms"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">                                    <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">                                    <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">                                    <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">            <tt class="py-name">output</tt><tt class="py-op">,</tt> <tt class="py-name">_</tt> <tt class="py-op">=</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">communicate</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-113" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-113', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage error listing "</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">                                     <tt class="py-string">"installed machines: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line"> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">        <tt id="link-114" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.machines()=lib.cuckoo.common.abstracts.Machinery-class.html#machines"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-114', 'machines', 'link-114');">machines</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">line</tt> <tt class="py-keyword">in</tt> <tt class="py-name">output</tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">"\n"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">                <tt id="link-115" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-115', 'label', 'link-33');">label</a></tt> <tt class="py-op">=</tt> <tt class="py-name">line</tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">'"'</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-116" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-116', 'label', 'link-33');">label</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"&lt;inaccessible&gt;"</tt><tt class="py-op">:</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                    <tt id="link-117" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-117', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Found an inaccessible virtual machine, "</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">                                <tt class="py-string">"please check its state."</tt><tt class="py-op">)</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">                    <tt id="link-118" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-118', 'machines', 'link-114');">machines</a></tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt id="link-119" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-119', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-name">IndexError</tt><tt class="py-op">:</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line"> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-120" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-120', 'machines', 'link-114');">machines</a></tt> </tt>
</div><a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox._status"></a><div id="VirtualBox._status-def"><a name="L197"></a><tt class="py-lineno">197</tt> <a class="py-toggle" href="#" id="VirtualBox._status-toggle" onclick="return toggle('VirtualBox._status');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#_status">_status</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox._status-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox._status-expanded"><a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">        <tt class="py-docstring">"""Gets current status of a vm.</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: virtual machine name.</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line"><tt class="py-docstring">        @return: status string.</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">        <tt id="link-121" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-121', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-122" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-122', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Getting status for %s"</tt> <tt class="py-op">%</tt> <tt id="link-123" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-123', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">        <tt id="link-124" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.status=lib.cuckoo.core.database.Guest-class.html#status,Variable lib.cuckoo.core.database.Machine.status=lib.cuckoo.core.database.Machine-class.html#status,Variable lib.cuckoo.core.database.Task.status=lib.cuckoo.core.database.Task-class.html#status"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-124', 'status', 'link-124');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">            <tt class="py-name">proc</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">Popen</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-125', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-126" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-126', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">                                     <tt class="py-string">"showvminfo"</tt><tt class="py-op">,</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">                                     <tt id="link-127" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-127', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">                                     <tt class="py-string">"--machinereadable"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">                                    <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">                                    <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">                                    <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">            <tt class="py-name">output</tt><tt class="py-op">,</tt> <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">communicate</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">returncode</tt> <tt class="py-op">!=</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">                <tt class="py-comment"># It's quite common for virtualbox crap utility to exit with:</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">                <tt class="py-comment"># VBoxManage: error: Details: code E_ACCESSDENIED (0x80070005)</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">                <tt class="py-comment"># So we just log to debug this.</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">                <tt id="link-128" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-128', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-129', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage returns error checking status for "</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">                          <tt class="py-string">"machine %s: %s"</tt><tt class="py-op">,</tt> <tt id="link-130" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-130', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">                <tt id="link-131" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-131', 'status', 'link-124');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-132" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-132', 'ERROR', 'link-20');">ERROR</a></tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">            <tt id="link-133" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-133', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed to check status for machine %s: %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">                        <tt id="link-134" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-134', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">            <tt id="link-135" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-135', 'status', 'link-124');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-136', 'ERROR', 'link-20');">ERROR</a></tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-137" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-137', 'status', 'link-124');">status</a></tt><tt class="py-op">:</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">line</tt> <tt class="py-keyword">in</tt> <tt class="py-name">output</tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">"\n"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">                <tt class="py-name">state</tt> <tt class="py-op">=</tt> <tt class="py-name">re</tt><tt class="py-op">.</tt><tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">r'VMState="(\w+)"'</tt><tt class="py-op">,</tt> <tt class="py-name">line</tt><tt class="py-op">,</tt> <tt class="py-name">re</tt><tt class="py-op">.</tt><tt class="py-name">M</tt> <tt class="py-op">|</tt> <tt class="py-name">re</tt><tt class="py-op">.</tt><tt class="py-name">I</tt><tt class="py-op">)</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">state</tt><tt class="py-op">:</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">                    <tt id="link-138" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-138', 'status', 'link-124');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">state</tt><tt class="py-op">.</tt><tt class="py-name">group</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">                    <tt id="link-139" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-139', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-140', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Machine %s status %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-141" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-141', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt id="link-142" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-142', 'status', 'link-124');">status</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">                    <tt id="link-143" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-143', 'status', 'link-124');">status</a></tt> <tt class="py-op">=</tt> <tt id="link-144" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-144', 'status', 'link-124');">status</a></tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">        <tt class="py-comment"># Report back status.</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-145" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-145', 'status', 'link-124');">status</a></tt><tt class="py-op">:</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-146" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.set_status()=lib.cuckoo.common.abstracts.Machinery-class.html#set_status,Method lib.cuckoo.core.database.Database.set_status()=lib.cuckoo.core.database.Database-class.html#set_status"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-146', 'set_status', 'link-146');">set_status</a></tt><tt class="py-op">(</tt><tt id="link-147" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-147', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt id="link-148" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-148', 'status', 'link-124');">status</a></tt><tt class="py-op">)</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt id="link-149" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-149', 'status', 'link-124');">status</a></tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-150" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-150', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unable to get status for %s"</tt> <tt class="py-op">%</tt> <tt id="link-151" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-151', 'label', 'link-33');">label</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line"> </tt>
<a name="VirtualBox.dump_memory"></a><div id="VirtualBox.dump_memory-def"><a name="L239"></a><tt class="py-lineno">239</tt> <a class="py-toggle" href="#" id="VirtualBox.dump_memory-toggle" onclick="return toggle('VirtualBox.dump_memory');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.virtualbox.VirtualBox-class.html#dump_memory">dump_memory</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirtualBox.dump_memory-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirtualBox.dump_memory-expanded"><a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">        <tt class="py-docstring">"""Takes a memory dump.</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line"><tt class="py-docstring">        @param path: path to where to store the memory dump.</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line"> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">            <tt class="py-name">proc</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">Popen</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-152" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-152', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-153" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-153', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-string">"-v"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">                                    <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">                                    <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">                                    <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">            <tt class="py-name">output</tt><tt class="py-op">,</tt> <tt class="py-name">err</tt> <tt class="py-op">=</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">communicate</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line"> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">proc</tt><tt class="py-op">.</tt><tt class="py-name">returncode</tt> <tt class="py-op">!=</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">                <tt class="py-comment"># It's quite common for virtualbox crap utility to exit with:</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">                <tt class="py-comment"># VBoxManage: error: Details: code E_ACCESSDENIED (0x80070005)</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">                <tt class="py-comment"># So we just log to debug this.</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">                <tt id="link-154" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-154', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-155', 'debug', 'link-32');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage returns error checking status for "</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">                          <tt class="py-string">"machine %s: %s"</tt><tt class="py-op">,</tt> <tt id="link-156" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-156', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">err</tt><tt class="py-op">)</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-157" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-157', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed return it's version: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line"> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">output</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-number">5</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">            <tt class="py-comment"># VirtualBox version 5.x</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">            <tt class="py-name">dumpcmd</tt> <tt class="py-op">=</tt> <tt class="py-string">"dumpvmcore"</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">            <tt class="py-comment"># VirtualBox version 4.x</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">            <tt class="py-name">dumpcmd</tt> <tt class="py-op">=</tt> <tt class="py-string">"dumpguestcore"</tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line"> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">            <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">call</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-158" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-158', 'options', 'link-21');">options</a></tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="modules.machinery.virtualbox" class="py-name" href="#" onclick="return doclink('link-159', 'virtualbox', 'link-22');">virtualbox</a></tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-string">"debugvm"</tt><tt class="py-op">,</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">                             <tt id="link-160" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-160', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">dumpcmd</tt><tt class="py-op">,</tt> <tt class="py-string">"--filename"</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">                            <tt class="py-name">stdout</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">                            <tt class="py-name">stderr</tt><tt class="py-op">=</tt><tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">PIPE</tt><tt class="py-op">,</tt> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">                            <tt class="py-name">close_fds</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">            <tt id="link-161" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-161', 'log', 'link-15');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Successfully generated memory dump for virtual machine "</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">                     <tt class="py-string">"with label %s to path %s"</tt><tt class="py-op">,</tt> <tt id="link-162" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-162', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-163" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-163', 'CuckooMachineError', 'link-14');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VBoxManage failed to take a memory "</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">                                     <tt class="py-string">"dump of the machine with label %s: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">                                     <tt class="py-op">(</tt><tt id="link-164" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-164', 'label', 'link-33');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Nov  4 23:21:59 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
