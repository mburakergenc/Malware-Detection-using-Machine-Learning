<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>modules.processing.virustotal</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="modules-module.html">Package&nbsp;modules</a> ::
        <a href="modules.processing-module.html">Package&nbsp;processing</a> ::
        Module&nbsp;virustotal
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="modules.processing.virustotal-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="modules.processing.virustotal-module.html">Module modules.processing.virustotal</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2010-2013 Claudio Guarnieri.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2014-2016 Cuckoo Foundation.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.abstracts=lib.cuckoo.common.abstracts-module.html"><a title="lib.cuckoo.common.abstracts" class="py-name" href="#" onclick="return doclink('link-3', 'abstracts', 'link-3');">abstracts</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Class lib.cuckoo.common.abstracts.Processing=lib.cuckoo.common.abstracts.Processing-class.html"><a title="lib.cuckoo.common.abstracts.Processing" class="py-name" href="#" onclick="return doclink('link-4', 'Processing', 'link-4');">Processing</a></tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-5', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-6" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-6', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-7', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-8', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooOperationalError=lib.cuckoo.common.exceptions.CuckooOperationalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-9', 'CuckooOperationalError', 'link-9');">CuckooOperationalError</a></tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-10', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-11', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-12', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-13', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooProcessingError=lib.cuckoo.common.exceptions.CuckooProcessingError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooProcessingError" class="py-name" href="#" onclick="return doclink('link-14', 'CuckooProcessingError', 'link-14');">CuckooProcessingError</a></tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-15" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-15', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-16', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-17" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-17', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-18" class="py-name" targets="Module lib.cuckoo.common.virustotal=lib.cuckoo.common.virustotal-module.html,Module modules.processing.virustotal=modules.processing.virustotal-module.html"><a title="lib.cuckoo.common.virustotal
modules.processing.virustotal" class="py-name" href="#" onclick="return doclink('link-18', 'virustotal', 'link-18');">virustotal</a></tt> <tt class="py-keyword">import</tt> <tt id="link-19" class="py-name" targets="Class lib.cuckoo.common.virustotal.VirusTotalAPI=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI" class="py-name" href="#" onclick="return doclink('link-19', 'VirusTotalAPI', 'link-19');">VirusTotalAPI</a></tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-20" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-20', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-21', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-22', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name"><a title="lib.cuckoo.common.virustotal
modules.processing.virustotal" class="py-name" href="#" onclick="return doclink('link-23', 'virustotal', 'link-18');">virustotal</a></tt> <tt class="py-keyword">import</tt> <tt id="link-24" class="py-name" targets="Class lib.cuckoo.common.virustotal.VirusTotalResourceNotScanned=lib.cuckoo.common.virustotal.VirusTotalResourceNotScanned-class.html"><a title="lib.cuckoo.common.virustotal.VirusTotalResourceNotScanned" class="py-name" href="#" onclick="return doclink('link-24', 'VirusTotalResourceNotScanned', 'link-24');">VirusTotalResourceNotScanned</a></tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt id="link-25" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.common.utils.log=lib.cuckoo.common.utils-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Module lib.cuckoo.core.log=lib.cuckoo.core.log-module.html,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.reboot.log=modules.auxiliary.reboot-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.debug.log=modules.processing.debug-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.irma.log=modules.processing.irma-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.misp.log=modules.processing.misp-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.procmemory.log=modules.processing.procmemory-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.elasticsearch.log=modules.reporting.elasticsearch-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-25', 'log', 'link-25');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"> </tt>
<a name="VirusTotal"></a><div id="VirusTotal-def"><a name="L17"></a><tt class="py-lineno"> 17</tt> <a class="py-toggle" href="#" id="VirusTotal-toggle" onclick="return toggle('VirusTotal');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="modules.processing.virustotal.VirusTotal-class.html">VirusTotal</a><tt class="py-op">(</tt><tt class="py-base-class">Processing</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirusTotal-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="VirusTotal-expanded"><a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line">    <tt class="py-docstring">"""Gets antivirus signatures from VirusTotal.com for various results.</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-docstring">    Currently obtains VirusTotal results for the target sample or URL and the</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-docstring">    dropped files.</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line">    <tt id="link-26" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Processing.order=lib.cuckoo.common.abstracts.Processing-class.html#order,Variable lib.cuckoo.common.abstracts.Report.order=lib.cuckoo.common.abstracts.Report-class.html#order,Variable lib.cuckoo.common.abstracts.Signature.order=lib.cuckoo.common.abstracts.Signature-class.html#order,Variable modules.processing.baseline.Baseline.order=modules.processing.baseline.Baseline-class.html#order,Variable modules.processing.dumptls.TLSMasterSecrets.order=modules.processing.dumptls.TLSMasterSecrets-class.html#order,Variable modules.processing.misp.MISP.order=modules.processing.misp.MISP-class.html#order,Variable modules.processing.network.NetworkAnalysis.order=modules.processing.network.NetworkAnalysis-class.html#order,Variable modules.processing.virustotal.VirusTotal.order=modules.processing.virustotal.VirusTotal-class.html#order"><a title="lib.cuckoo.common.abstracts.Processing.order
lib.cuckoo.common.abstracts.Report.order
lib.cuckoo.common.abstracts.Signature.order
modules.processing.baseline.Baseline.order
modules.processing.dumptls.TLSMasterSecrets.order
modules.processing.misp.MISP.order
modules.processing.network.NetworkAnalysis.order
modules.processing.virustotal.VirusTotal.order" class="py-name" href="#" onclick="return doclink('link-26', 'order', 'link-26');">order</a></tt> <tt class="py-op">=</tt> <tt class="py-number">2</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"> </tt>
<a name="VirusTotal.run"></a><div id="VirusTotal.run-def"><a name="L25"></a><tt class="py-lineno"> 25</tt> <a class="py-toggle" href="#" id="VirusTotal.run-toggle" onclick="return toggle('VirusTotal.run');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.processing.virustotal.VirusTotal-class.html#run">run</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirusTotal.run-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirusTotal.run-expanded"><a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line">        <tt class="py-docstring">"""Runs VirusTotal processing</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-docstring">        @return: full VirusTotal report.</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-27" class="py-name" targets="Variable lib.cuckoo.common.abstracts.BehaviorHandler.key=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#key,Variable modules.processing.behavior.Anomaly.key=modules.processing.behavior.Anomaly-class.html#key,Variable modules.processing.behavior.ApiStats.key=modules.processing.behavior.ApiStats-class.html#key,Variable modules.processing.behavior.BehaviorAnalysis.key=modules.processing.behavior.BehaviorAnalysis-class.html#key,Variable modules.processing.behavior.GenericBehavior.key=modules.processing.behavior.GenericBehavior-class.html#key,Variable modules.processing.behavior.ProcessTree.key=modules.processing.behavior.ProcessTree-class.html#key,Variable modules.processing.behavior.Summary.key=modules.processing.behavior.Summary-class.html#key,Variable modules.processing.dumptls.TLSMasterSecrets.key=modules.processing.dumptls.TLSMasterSecrets-class.html#key,Variable modules.processing.network.NetworkAnalysis.key=modules.processing.network.NetworkAnalysis-class.html#key,Variable modules.processing.platform.linux.LinuxSystemTap.key=modules.processing.platform.linux.LinuxSystemTap-class.html#key,Variable modules.processing.platform.windows.WindowsMonitor.key=modules.processing.platform.windows.WindowsMonitor-class.html#key,Variable modules.processing.procmon.Procmon.key=modules.processing.procmon.Procmon-class.html#key"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key
modules.processing.procmon.Procmon.key" class="py-name" href="#" onclick="return doclink('link-27', 'key', 'link-27');">key</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"virustotal"</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line">        <tt class="py-name">apikey</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-28" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Method lib.cuckoo.core.database.Task.options()=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-28', 'options', 'link-28');">options</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name" targets="Method lib.cuckoo.common.config.Config.get()=lib.cuckoo.common.config.Config-class.html#get,Method lib.cuckoo.core.guest.GuestManager.get()=lib.cuckoo.core.guest.GuestManager-class.html#get"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-29', 'get', 'link-29');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"key"</tt><tt class="py-op">)</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line">        <tt id="link-30" class="py-name" targets="Variable lib.cuckoo.core.database.Task.timeout=lib.cuckoo.core.database.Task-class.html#timeout"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-30', 'timeout', 'link-30');">timeout</a></tt> <tt class="py-op">=</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-31" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-31', 'options', 'link-28');">options</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-32', 'get', 'link-29');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"timeout"</tt><tt class="py-op">,</tt> <tt class="py-number">60</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line">        <tt class="py-name">scan</tt> <tt class="py-op">=</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-33" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-33', 'options', 'link-28');">options</a></tt><tt class="py-op">.</tt><tt id="link-34" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-34', 'get', 'link-29');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"scan"</tt><tt class="py-op">,</tt> <tt class="py-number">0</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">apikey</tt><tt class="py-op">:</tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-35" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooProcessingError" class="py-name" href="#" onclick="return doclink('link-35', 'CuckooProcessingError', 'link-14');">CuckooProcessingError</a></tt><tt class="py-op">(</tt><tt class="py-string">"VirusTotal API key not "</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line">                                        <tt class="py-string">"configured, skipping VirusTotal "</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line">                                        <tt class="py-string">"processing module."</tt><tt class="py-op">)</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vt</tt> <tt class="py-op">=</tt> <tt id="link-36" class="py-name"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI" class="py-name" href="#" onclick="return doclink('link-36', 'VirusTotalAPI', 'link-19');">VirusTotalAPI</a></tt><tt class="py-op">(</tt><tt class="py-name">apikey</tt><tt class="py-op">,</tt> <tt id="link-37" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-37', 'timeout', 'link-30');">timeout</a></tt><tt class="py-op">,</tt> <tt class="py-name">scan</tt><tt class="py-op">)</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">        <tt class="py-comment"># Scan the original sample or URL.</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line">            <tt id="link-38" class="py-name" targets="Method lib.cuckoo.common.abstracts.Signature.results()=lib.cuckoo.common.abstracts.Signature-class.html#results"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-38', 'results', 'link-38');">results</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-39" class="py-name" targets="Method modules.processing.virustotal.VirusTotal.scan_file()=modules.processing.virustotal.VirusTotal-class.html#scan_file"><a title="modules.processing.virustotal.VirusTotal.scan_file" class="py-name" href="#" onclick="return doclink('link-39', 'scan_file', 'link-39');">scan_file</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">file_path</tt><tt class="py-op">)</tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"url"</tt><tt class="py-op">:</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">            <tt id="link-40" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-40', 'results', 'link-38');">results</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-41" class="py-name" targets="Method modules.processing.virustotal.VirusTotal.scan_url()=modules.processing.virustotal.VirusTotal-class.html#scan_url"><a title="modules.processing.virustotal.VirusTotal.scan_url" class="py-name" href="#" onclick="return doclink('link-41', 'scan_url', 'link-41');">scan_url</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"target"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"baseline"</tt><tt class="py-op">:</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"service"</tt><tt class="py-op">:</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-42" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooProcessingError" class="py-name" href="#" onclick="return doclink('link-42', 'CuckooProcessingError', 'link-14');">CuckooProcessingError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unsupported task category: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">                                        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">task</tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">        <tt class="py-comment"># Scan any dropped files that have an interesting filetype.</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">row</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-43" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-43', 'results', 'link-38');">results</a></tt><tt class="py-op">.</tt><tt id="link-44" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-44', 'get', 'link-29');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"dropped"</tt><tt class="py-op">,</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-45" class="py-name" targets="Method modules.processing.virustotal.VirusTotal.should_scan_file()=modules.processing.virustotal.VirusTotal-class.html#should_scan_file"><a title="modules.processing.virustotal.VirusTotal.should_scan_file" class="py-name" href="#" onclick="return doclink('link-45', 'should_scan_file', 'link-45');">should_scan_file</a></tt><tt class="py-op">(</tt><tt class="py-name">row</tt><tt class="py-op">[</tt><tt class="py-string">"type"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">            <tt class="py-name">row</tt><tt class="py-op">[</tt><tt class="py-string">"virustotal"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-46" class="py-name"><a title="modules.processing.virustotal.VirusTotal.scan_file" class="py-name" href="#" onclick="return doclink('link-46', 'scan_file', 'link-39');">scan_file</a></tt><tt class="py-op">(</tt><tt class="py-name">row</tt><tt class="py-op">[</tt><tt class="py-string">"path"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">summary</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-47" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-47', 'results', 'link-38');">results</a></tt> </tt>
</div><a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line"> </tt>
<a name="VirusTotal.scan_file"></a><div id="VirusTotal.scan_file-def"><a name="L64"></a><tt class="py-lineno"> 64</tt> <a class="py-toggle" href="#" id="VirusTotal.scan_file-toggle" onclick="return toggle('VirusTotal.scan_file');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.processing.virustotal.VirusTotal-class.html#scan_file">scan_file</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">filepath</tt><tt class="py-op">,</tt> <tt class="py-param">summary</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirusTotal.scan_file-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirusTotal.scan_file-expanded"><a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-docstring">"""Retrieve VirusTotal results for a file.</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line"><tt class="py-docstring">        @param filepath: file path</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"><tt class="py-docstring">        @param summary: if you want a summary report</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">            <tt id="link-48" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-48', 'log', 'link-25');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Path \"%s\" could not be found for VirusTotal "</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">                        <tt class="py-string">"lookup, skipping it"</tt><tt class="py-op">,</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">basename</tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line"> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vt</tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Method lib.cuckoo.common.virustotal.VirusTotalAPI.file_report()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#file_report"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI.file_report" class="py-name" href="#" onclick="return doclink('link-49', 'file_report', 'link-49');">file_report</a></tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">,</tt> <tt class="py-name">summary</tt><tt class="py-op">=</tt><tt class="py-name">summary</tt><tt class="py-op">)</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-50" class="py-name"><a title="lib.cuckoo.common.virustotal.VirusTotalResourceNotScanned" class="py-name" href="#" onclick="return doclink('link-50', 'VirusTotalResourceNotScanned', 'link-24');">VirusTotalResourceNotScanned</a></tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vt</tt><tt class="py-op">.</tt><tt id="link-51" class="py-name" targets="Method lib.cuckoo.common.virustotal.VirusTotalAPI.file_scan()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#file_scan"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI.file_scan" class="py-name" href="#" onclick="return doclink('link-51', 'file_scan', 'link-51');">file_scan</a></tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-52" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-52', 'CuckooOperationalError', 'link-9');">CuckooOperationalError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">            <tt id="link-53" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-53', 'log', 'link-25');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error fetching results from VirusTotal for "</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">                        <tt class="py-string">"\"%s\": %s"</tt><tt class="py-op">,</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">basename</tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name" targets="Variable lib.cuckoo.core.database.Error.message=lib.cuckoo.core.database.Error-class.html#message"><a title="lib.cuckoo.core.database.Error.message" class="py-name" href="#" onclick="return doclink('link-54', 'message', 'link-54');">message</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line"> </tt>
<a name="VirusTotal.scan_url"></a><div id="VirusTotal.scan_url-def"><a name="L82"></a><tt class="py-lineno"> 82</tt> <a class="py-toggle" href="#" id="VirusTotal.scan_url-toggle" onclick="return toggle('VirusTotal.scan_url');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.processing.virustotal.VirusTotal-class.html#scan_url">scan_url</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">url</tt><tt class="py-op">,</tt> <tt class="py-param">summary</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirusTotal.scan_url-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirusTotal.scan_url-expanded"><a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">        <tt class="py-docstring">"""Retrieve VirusTotal results for a URL.</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line"><tt class="py-docstring">        @param url: URL</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line"><tt class="py-docstring">        @param summary: if you want a summary report</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vt</tt><tt class="py-op">.</tt><tt id="link-55" class="py-name" targets="Method lib.cuckoo.common.virustotal.VirusTotalAPI.url_report()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#url_report"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI.url_report" class="py-name" href="#" onclick="return doclink('link-55', 'url_report', 'link-55');">url_report</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">summary</tt><tt class="py-op">=</tt><tt class="py-name">summary</tt><tt class="py-op">)</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-56" class="py-name"><a title="lib.cuckoo.common.virustotal.VirusTotalResourceNotScanned" class="py-name" href="#" onclick="return doclink('link-56', 'VirusTotalResourceNotScanned', 'link-24');">VirusTotalResourceNotScanned</a></tt><tt class="py-op">:</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vt</tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Method lib.cuckoo.common.virustotal.VirusTotalAPI.url_scan()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#url_scan"><a title="lib.cuckoo.common.virustotal.VirusTotalAPI.url_scan" class="py-name" href="#" onclick="return doclink('link-57', 'url_scan', 'link-57');">url_scan</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">)</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-58" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-58', 'CuckooOperationalError', 'link-9');">CuckooOperationalError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">            <tt id="link-59" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-59', 'log', 'link-25');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error fetching results from VirusTotal for "</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">                        <tt class="py-string">"\"%s\": %s"</tt><tt class="py-op">,</tt> <tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="lib.cuckoo.core.database.Error.message" class="py-name" href="#" onclick="return doclink('link-60', 'message', 'link-54');">message</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line"> </tt>
<a name="VirusTotal.should_scan_file"></a><div id="VirusTotal.should_scan_file-def"><a name="L95"></a><tt class="py-lineno"> 95</tt> <a class="py-toggle" href="#" id="VirusTotal.should_scan_file-toggle" onclick="return toggle('VirusTotal.should_scan_file');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.processing.virustotal.VirusTotal-class.html#should_scan_file">should_scan_file</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">filetype</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="VirusTotal.should_scan_file-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="VirusTotal.should_scan_file-expanded"><a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">        <tt class="py-docstring">"""Determines whether a certain filetype should be scanned on</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line"><tt class="py-docstring">        VirusTotal. For example, we're not interested in scanning text</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"><tt class="py-docstring">        files.</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"><tt class="py-docstring">        @param filetype: file type</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-string">"PE32"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">filetype</tt> <tt class="py-keyword">or</tt> <tt class="py-string">"MS-DOS"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">filetype</tt> </tt>
</div></div><a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Nov  4 23:22:00 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
