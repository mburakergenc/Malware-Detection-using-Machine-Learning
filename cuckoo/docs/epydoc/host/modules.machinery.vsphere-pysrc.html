<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>modules.machinery.vsphere</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="modules-module.html">Package&nbsp;modules</a> ::
        <a href="modules.machinery-module.html">Package&nbsp;machinery</a> ::
        Module&nbsp;vsphere
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="modules.machinery.vsphere-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="modules.machinery.vsphere-module.html">Module modules.machinery.vsphere</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2015 eSentire, Inc (jacob.gajek@esentire.com).</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">datetime</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">random</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">re</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">requests</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">ssl</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.abstracts=lib.cuckoo.common.abstracts-module.html"><a title="lib.cuckoo.common.abstracts" class="py-name" href="#" onclick="return doclink('link-3', 'abstracts', 'link-3');">abstracts</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Class lib.cuckoo.common.abstracts.Machinery=lib.cuckoo.common.abstracts.Machinery-class.html"><a title="lib.cuckoo.common.abstracts.Machinery" class="py-name" href="#" onclick="return doclink('link-4', 'Machinery', 'link-4');">Machinery</a></tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-5', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-6" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-6', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-7', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-8', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooMachineError=lib.cuckoo.common.exceptions.CuckooMachineError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-9', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-10', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-11', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-12', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-13', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooDependencyError=lib.cuckoo.common.exceptions.CuckooDependencyError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooDependencyError" class="py-name" href="#" onclick="return doclink('link-14', 'CuckooDependencyError', 'link-14');">CuckooDependencyError</a></tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-15" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-15', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-16', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-17" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-17', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-18" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-18', 'exceptions', 'link-8');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-19" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooCriticalError=lib.cuckoo.common.exceptions.CuckooCriticalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-19', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line">    <tt class="py-keyword">from</tt> <tt class="py-name">pyVim</tt><tt class="py-op">.</tt><tt id="link-20" class="py-name" targets="Method modules.reporting.elasticsearch.ElasticSearch.connect()=modules.reporting.elasticsearch.ElasticSearch-class.html#connect,Method modules.reporting.mongodb.MongoDB.connect()=modules.reporting.mongodb.MongoDB-class.html#connect"><a title="modules.reporting.elasticsearch.ElasticSearch.connect
modules.reporting.mongodb.MongoDB.connect" class="py-name" href="#" onclick="return doclink('link-20', 'connect', 'link-20');">connect</a></tt> <tt class="py-keyword">import</tt> <tt class="py-name">SmartConnection</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line">    <tt id="link-21" class="py-name" targets="Variable modules.machinery.vsphere.HAVE_PYVMOMI=modules.machinery.vsphere-module.html#HAVE_PYVMOMI"><a title="modules.machinery.vsphere.HAVE_PYVMOMI" class="py-name" href="#" onclick="return doclink('link-21', 'HAVE_PYVMOMI', 'link-21');">HAVE_PYVMOMI</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">except</tt> <tt class="py-name">ImportError</tt><tt class="py-op">:</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line">    <tt id="link-22" class="py-name"><a title="modules.machinery.vsphere.HAVE_PYVMOMI" class="py-name" href="#" onclick="return doclink('link-22', 'HAVE_PYVMOMI', 'link-21');">HAVE_PYVMOMI</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt id="link-23" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.common.utils.log=lib.cuckoo.common.utils-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Module lib.cuckoo.core.log=lib.cuckoo.core.log-module.html,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.reboot.log=modules.auxiliary.reboot-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.debug.log=modules.processing.debug-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.irma.log=modules.processing.irma-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.misp.log=modules.processing.misp-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.procmemory.log=modules.processing.procmemory-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.elasticsearch.log=modules.reporting.elasticsearch-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-23', 'log', 'link-23');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-string">"requests"</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">setLevel</tt><tt class="py-op">(</tt><tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">WARNING</tt><tt class="py-op">)</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"> </tt>
<a name="vSphere"></a><div id="vSphere-def"><a name="L28"></a><tt class="py-lineno"> 28</tt> <a class="py-toggle" href="#" id="vSphere-toggle" onclick="return toggle('vSphere');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html">vSphere</a><tt class="py-op">(</tt><tt class="py-base-class">Machinery</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="vSphere-expanded"><a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line">    <tt class="py-docstring">"""vSphere/ESXi machinery class based on pyVmomi Python SDK."""</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line">    <tt class="py-comment"># VM states</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line">    <tt id="link-24" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#RUNNING,Variable modules.machinery.physical.Physical.RUNNING=modules.machinery.physical.Physical-class.html#RUNNING,Variable modules.machinery.qemu.QEMU.RUNNING=modules.machinery.qemu.QEMU-class.html#RUNNING,Variable modules.machinery.virtualbox.VirtualBox.RUNNING=modules.machinery.virtualbox.VirtualBox-class.html#RUNNING,Variable modules.machinery.vsphere.vSphere.RUNNING=modules.machinery.vsphere.vSphere-class.html#RUNNING,Variable modules.machinery.xenserver.XenServerMachinery.RUNNING=modules.machinery.xenserver.XenServerMachinery-class.html#RUNNING"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-24', 'RUNNING', 'link-24');">RUNNING</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"poweredOn"</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line">    <tt id="link-25" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#POWEROFF,Variable modules.machinery.virtualbox.VirtualBox.POWEROFF=modules.machinery.virtualbox.VirtualBox-class.html#POWEROFF,Variable modules.machinery.vsphere.vSphere.POWEROFF=modules.machinery.vsphere.vSphere-class.html#POWEROFF,Variable modules.machinery.xenserver.XenServerMachinery.POWEROFF=modules.machinery.xenserver.XenServerMachinery-class.html#POWEROFF"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.POWEROFF
modules.machinery.virtualbox.VirtualBox.POWEROFF
modules.machinery.vsphere.vSphere.POWEROFF
modules.machinery.xenserver.XenServerMachinery.POWEROFF" class="py-name" href="#" onclick="return doclink('link-25', 'POWEROFF', 'link-25');">POWEROFF</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"poweredOff"</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line">    <tt id="link-26" class="py-name" targets="Variable modules.machinery.vsphere.vSphere.SUSPENDED=modules.machinery.vsphere.vSphere-class.html#SUSPENDED"><a title="modules.machinery.vsphere.vSphere.SUSPENDED" class="py-name" href="#" onclick="return doclink('link-26', 'SUSPENDED', 'link-26');">SUSPENDED</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"suspended"</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line">    <tt id="link-27" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#ABORTED,Variable modules.machinery.virtualbox.VirtualBox.ABORTED=modules.machinery.virtualbox.VirtualBox-class.html#ABORTED,Variable modules.machinery.vsphere.vSphere.ABORTED=modules.machinery.vsphere.vSphere-class.html#ABORTED,Variable modules.machinery.xenserver.XenServerMachinery.ABORTED=modules.machinery.xenserver.XenServerMachinery-class.html#ABORTED"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ABORTED
modules.machinery.virtualbox.VirtualBox.ABORTED
modules.machinery.vsphere.vSphere.ABORTED
modules.machinery.xenserver.XenServerMachinery.ABORTED" class="py-name" href="#" onclick="return doclink('link-27', 'ABORTED', 'link-27');">ABORTED</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"aborted"</tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"> </tt>
<a name="vSphere.__init__"></a><div id="vSphere.__init__-def"><a name="L37"></a><tt class="py-lineno"> 37</tt> <a class="py-toggle" href="#" id="vSphere.__init__-toggle" onclick="return toggle('vSphere.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere.__init__-expanded"><a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-28" class="py-name"><a title="modules.machinery.vsphere.HAVE_PYVMOMI" class="py-name" href="#" onclick="return doclink('link-28', 'HAVE_PYVMOMI', 'link-21');">HAVE_PYVMOMI</a></tt><tt class="py-op">:</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-29" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooDependencyError" class="py-name" href="#" onclick="return doclink('link-29', 'CuckooDependencyError', 'link-14');">CuckooDependencyError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line">                <tt class="py-string">"Couldn't import pyVmomi, please install it (using "</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line">                <tt class="py-string">"`pip install -U pyvmomi`)"</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line">        <tt class="py-name">super</tt><tt class="py-op">(</tt><tt id="link-30" class="py-name" targets="Class modules.machinery.vsphere.vSphere=modules.machinery.vsphere.vSphere-class.html"><a title="modules.machinery.vsphere.vSphere" class="py-name" href="#" onclick="return doclink('link-30', 'vSphere', 'link-30');">vSphere</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-31" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.__init__()=lib.cuckoo.common.abstracts.Auxiliary-class.html#__init__,Method lib.cuckoo.common.abstracts.BehaviorHandler.__init__()=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#__init__,Method lib.cuckoo.common.abstracts.LibVirtMachinery.__init__()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#__init__,Method lib.cuckoo.common.abstracts.Machinery.__init__()=lib.cuckoo.common.abstracts.Machinery-class.html#__init__,Method lib.cuckoo.common.abstracts.Processing.__init__()=lib.cuckoo.common.abstracts.Processing-class.html#__init__,Method lib.cuckoo.common.abstracts.ProtocolHandler.__init__()=lib.cuckoo.common.abstracts.ProtocolHandler-class.html#__init__,Method lib.cuckoo.common.abstracts.Report.__init__()=lib.cuckoo.common.abstracts.Report-class.html#__init__,Method lib.cuckoo.common.abstracts.Signature.__init__()=lib.cuckoo.common.abstracts.Signature-class.html#__init__,Method lib.cuckoo.common.config.Config.__init__()=lib.cuckoo.common.config.Config-class.html#__init__,Method lib.cuckoo.common.irc.ircMessage.__init__()=lib.cuckoo.common.irc.ircMessage-class.html#__init__,Method lib.cuckoo.common.objects.File.__init__()=lib.cuckoo.common.objects.File-class.html#__init__,Method lib.cuckoo.common.objects.URL.__init__()=lib.cuckoo.common.objects.URL-class.html#__init__,Method lib.cuckoo.common.utils.SuperLock.__init__()=lib.cuckoo.common.utils.SuperLock-class.html#__init__,Method lib.cuckoo.common.utils.TimeoutServer.__init__()=lib.cuckoo.common.utils.TimeoutServer-class.html#__init__,Method lib.cuckoo.common.utils.TimeoutTransport.__init__()=lib.cuckoo.common.utils.TimeoutTransport-class.html#__init__,Method lib.cuckoo.common.virustotal.VirusTotalAPI.__init__()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#__init__,Method lib.cuckoo.core.database.Database.__init__()=lib.cuckoo.core.database.Database-class.html#__init__,Method lib.cuckoo.core.database.Error.__init__()=lib.cuckoo.core.database.Error-class.html#__init__,Method lib.cuckoo.core.database.Guest.__init__()=lib.cuckoo.core.database.Guest-class.html#__init__,Method lib.cuckoo.core.database.Machine.__init__()=lib.cuckoo.core.database.Machine-class.html#__init__,Method lib.cuckoo.core.database.Sample.__init__()=lib.cuckoo.core.database.Sample-class.html#__init__,Method lib.cuckoo.core.database.Tag.__init__()=lib.cuckoo.core.database.Tag-class.html#__init__,Method lib.cuckoo.core.database.Task.__init__()=lib.cuckoo.core.database.Task-class.html#__init__,Method lib.cuckoo.core.guest.GuestManager.__init__()=lib.cuckoo.core.guest.GuestManager-class.html#__init__,Method lib.cuckoo.core.guest.OldGuestManager.__init__()=lib.cuckoo.core.guest.OldGuestManager-class.html#__init__,Method lib.cuckoo.core.plugins.RunAuxiliary.__init__()=lib.cuckoo.core.plugins.RunAuxiliary-class.html#__init__,Method lib.cuckoo.core.plugins.RunProcessing.__init__()=lib.cuckoo.core.plugins.RunProcessing-class.html#__init__,Method lib.cuckoo.core.plugins.RunReporting.__init__()=lib.cuckoo.core.plugins.RunReporting-class.html#__init__,Method lib.cuckoo.core.plugins.RunSignatures.__init__()=lib.cuckoo.core.plugins.RunSignatures-class.html#__init__,Method lib.cuckoo.core.resultserver.ResultServer.__init__()=lib.cuckoo.core.resultserver.ResultServer-class.html#__init__,Method lib.cuckoo.core.scheduler.AnalysisManager.__init__()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#__init__,Method lib.cuckoo.core.scheduler.Scheduler.__init__()=lib.cuckoo.core.scheduler.Scheduler-class.html#__init__,Method modules.auxiliary.mitm.MITM.__init__()=modules.auxiliary.mitm.MITM-class.html#__init__,Method modules.auxiliary.sniffer.Sniffer.__init__()=modules.auxiliary.sniffer.Sniffer-class.html#__init__,Method modules.machinery.qemu.QEMU.__init__()=modules.machinery.qemu.QEMU-class.html#__init__,Method modules.machinery.vsphere.vSphere.__init__()=modules.machinery.vsphere.vSphere-class.html#__init__,Method modules.processing.behavior.Anomaly.__init__()=modules.processing.behavior.Anomaly-class.html#__init__,Method modules.processing.behavior.ApiStats.__init__()=modules.processing.behavior.ApiStats-class.html#__init__,Method modules.processing.behavior.GenericBehavior.__init__()=modules.processing.behavior.GenericBehavior-class.html#__init__,Method modules.processing.behavior.ProcessTree.__init__()=modules.processing.behavior.ProcessTree-class.html#__init__,Method modules.processing.behavior.RebootInformation.__init__()=modules.processing.behavior.RebootInformation-class.html#__init__,Method modules.processing.behavior.Summary.__init__()=modules.processing.behavior.Summary-class.html#__init__,Method modules.processing.debug.Logfile.__init__()=modules.processing.debug.Logfile-class.html#__init__,Method modules.processing.droidmon.Droidmon.__init__()=modules.processing.droidmon.Droidmon-class.html#__init__,Method modules.processing.memory.VolatilityAPI.__init__()=modules.processing.memory.VolatilityAPI-class.html#__init__,Method modules.processing.memory.VolatilityManager.__init__()=modules.processing.memory.VolatilityManager-class.html#__init__,Method modules.processing.network.Pcap.__init__()=modules.processing.network.Pcap-class.html#__init__,Method modules.processing.network.Pcap2.__init__()=modules.processing.network.Pcap2-class.html#__init__,Method modules.processing.network.SortCap.__init__()=modules.processing.network.SortCap-class.html#__init__,Method modules.processing.platform.linux.FilteredProcessLog.__init__()=modules.processing.platform.linux.FilteredProcessLog-class.html#__init__,Method modules.processing.platform.linux.LinuxSystemTap.__init__()=modules.processing.platform.linux.LinuxSystemTap-class.html#__init__,Method modules.processing.platform.linux.StapParser.__init__()=modules.processing.platform.linux.StapParser-class.html#__init__,Method modules.processing.platform.windows.BehaviorReconstructor.__init__()=modules.processing.platform.windows.BehaviorReconstructor-class.html#__init__,Method modules.processing.platform.windows.MonitorProcessLog.__init__()=modules.processing.platform.windows.MonitorProcessLog-class.html#__init__,Method modules.processing.platform.windows.WindowsMonitor.__init__()=modules.processing.platform.windows.WindowsMonitor-class.html#__init__,Method modules.processing.procmon.ProcmonLog.__init__()=modules.processing.procmon.ProcmonLog-class.html#__init__,Method modules.processing.static.OfficeDocument.__init__()=modules.processing.static.OfficeDocument-class.html#__init__,Method modules.processing.static.PdfDocument.__init__()=modules.processing.static.PdfDocument-class.html#__init__,Method modules.processing.static.PortableExecutable.__init__()=modules.processing.static.PortableExecutable-class.html#__init__,Method modules.processing.static.WindowsScriptFile.__init__()=modules.processing.static.WindowsScriptFile-class.html#__init__"><a title="lib.cuckoo.common.abstracts.Auxiliary.__init__
lib.cuckoo.common.abstracts.BehaviorHandler.__init__
lib.cuckoo.common.abstracts.LibVirtMachinery.__init__
lib.cuckoo.common.abstracts.Machinery.__init__
lib.cuckoo.common.abstracts.Processing.__init__
lib.cuckoo.common.abstracts.ProtocolHandler.__init__
lib.cuckoo.common.abstracts.Report.__init__
lib.cuckoo.common.abstracts.Signature.__init__
lib.cuckoo.common.config.Config.__init__
lib.cuckoo.common.irc.ircMessage.__init__
lib.cuckoo.common.objects.File.__init__
lib.cuckoo.common.objects.URL.__init__
lib.cuckoo.common.utils.SuperLock.__init__
lib.cuckoo.common.utils.TimeoutServer.__init__
lib.cuckoo.common.utils.TimeoutTransport.__init__
lib.cuckoo.common.virustotal.VirusTotalAPI.__init__
lib.cuckoo.core.database.Database.__init__
lib.cuckoo.core.database.Error.__init__
lib.cuckoo.core.database.Guest.__init__
lib.cuckoo.core.database.Machine.__init__
lib.cuckoo.core.database.Sample.__init__
lib.cuckoo.core.database.Tag.__init__
lib.cuckoo.core.database.Task.__init__
lib.cuckoo.core.guest.GuestManager.__init__
lib.cuckoo.core.guest.OldGuestManager.__init__
lib.cuckoo.core.plugins.RunAuxiliary.__init__
lib.cuckoo.core.plugins.RunProcessing.__init__
lib.cuckoo.core.plugins.RunReporting.__init__
lib.cuckoo.core.plugins.RunSignatures.__init__
lib.cuckoo.core.resultserver.ResultServer.__init__
lib.cuckoo.core.scheduler.AnalysisManager.__init__
lib.cuckoo.core.scheduler.Scheduler.__init__
modules.auxiliary.mitm.MITM.__init__
modules.auxiliary.sniffer.Sniffer.__init__
modules.machinery.qemu.QEMU.__init__
modules.machinery.vsphere.vSphere.__init__
modules.processing.behavior.Anomaly.__init__
modules.processing.behavior.ApiStats.__init__
modules.processing.behavior.GenericBehavior.__init__
modules.processing.behavior.ProcessTree.__init__
modules.processing.behavior.RebootInformation.__init__
modules.processing.behavior.Summary.__init__
modules.processing.debug.Logfile.__init__
modules.processing.droidmon.Droidmon.__init__
modules.processing.memory.VolatilityAPI.__init__
modules.processing.memory.VolatilityManager.__init__
modules.processing.network.Pcap.__init__
modules.processing.network.Pcap2.__init__
modules.processing.network.SortCap.__init__
modules.processing.platform.linux.FilteredProcessLog.__init__
modules.processing.platform.linux.LinuxSystemTap.__init__
modules.processing.platform.linux.StapParser.__init__
modules.processing.platform.windows.BehaviorReconstructor.__init__
modules.processing.platform.windows.MonitorProcessLog.__init__
modules.processing.platform.windows.WindowsMonitor.__init__
modules.processing.procmon.ProcmonLog.__init__
modules.processing.static.OfficeDocument.__init__
modules.processing.static.PdfDocument.__init__
modules.processing.static.PortableExecutable.__init__
modules.processing.static.WindowsScriptFile.__init__" class="py-name" href="#" onclick="return doclink('link-31', '__init__', 'link-31');">__init__</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"> </tt>
<a name="vSphere._initialize"></a><div id="vSphere._initialize-def"><a name="L46"></a><tt class="py-lineno"> 46</tt> <a class="py-toggle" href="#" id="vSphere._initialize-toggle" onclick="return toggle('vSphere._initialize');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_initialize">_initialize</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">module_name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._initialize-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._initialize-expanded"><a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line">        <tt class="py-docstring">"""Read configuration.</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-docstring">        @param module_name: module name.</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-name">super</tt><tt class="py-op">(</tt><tt id="link-32" class="py-name"><a title="modules.machinery.vsphere.vSphere" class="py-name" href="#" onclick="return doclink('link-32', 'vSphere', 'link-30');">vSphere</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-33" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery._initialize()=lib.cuckoo.common.abstracts.Machinery-class.html#_initialize,Method modules.machinery.vsphere.vSphere._initialize()=modules.machinery.vsphere.vSphere-class.html#_initialize"><a title="lib.cuckoo.common.abstracts.Machinery._initialize
modules.machinery.vsphere.vSphere._initialize" class="py-name" href="#" onclick="return doclink('link-33', '_initialize', 'link-33');">_initialize</a></tt><tt class="py-op">(</tt><tt class="py-name">module_name</tt><tt class="py-op">)</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">        <tt class="py-comment"># Initialize random number generator</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">        <tt class="py-name">random</tt><tt class="py-op">.</tt><tt class="py-name">seed</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"> </tt>
<a name="vSphere._initialize_check"></a><div id="vSphere._initialize_check-def"><a name="L55"></a><tt class="py-lineno"> 55</tt> <a class="py-toggle" href="#" id="vSphere._initialize_check-toggle" onclick="return toggle('vSphere._initialize_check');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_initialize_check">_initialize_check</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._initialize_check-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._initialize_check-expanded"><a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">        <tt class="py-docstring">"""Runs checks against virtualization software when a machine manager</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"><tt class="py-docstring">        is initialized.</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooCriticalError: if a misconfiguration or unsupported state</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"><tt class="py-docstring">                                    is found.</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-34" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Method lib.cuckoo.core.database.Task.options()=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-34', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-35" class="py-name" targets="Module modules.machinery.vsphere=modules.machinery.vsphere-module.html"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-35', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">host</tt><tt class="py-op">:</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"host"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-36" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-36', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-37', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">host</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-38" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-38', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">                <tt class="py-string">"vSphere host address setting not found, please add it "</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">                <tt class="py-string">"to the config file."</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line"> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-39" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-39', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-40" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-40', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">port</tt><tt class="py-op">:</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"port"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-41" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-41', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-42" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-42', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">port</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-43" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-43', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">                <tt class="py-string">"vSphere port setting not found, please add it to the "</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">                <tt class="py-string">"config file."</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-44" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-44', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-45" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-45', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">user</tt><tt class="py-op">:</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"user"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-46" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-46', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-47', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">user</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-48" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-48', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">                <tt class="py-string">"vSphere username setting not found, please add it to "</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">                <tt class="py-string">"the config file."</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-49" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-49', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-50" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-50', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">pwd</tt><tt class="py-op">:</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"pwd"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-51" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-51', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-52" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-52', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">pwd</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-53" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-53', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">                <tt class="py-string">"vSphere password setting not found, please add it to "</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">                <tt class="py-string">"the config file."</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line"> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">        <tt class="py-comment"># Workaround for PEP-0476 issues in recent Python versions</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-54', 'options', 'link-34');">options</a></tt><tt class="py-op">.</tt><tt id="link-55" class="py-name"><a title="modules.machinery.vsphere" class="py-name" href="#" onclick="return doclink('link-55', 'vsphere', 'link-35');">vsphere</a></tt><tt class="py-op">.</tt><tt class="py-name">unverified_ssl</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">            <tt class="py-name">sslContext</tt> <tt class="py-op">=</tt> <tt class="py-name">ssl</tt><tt class="py-op">.</tt><tt class="py-name">SSLContext</tt><tt class="py-op">(</tt><tt class="py-name">ssl</tt><tt class="py-op">.</tt><tt class="py-name">PROTOCOL_TLSv1</tt><tt class="py-op">)</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">            <tt class="py-name">sslContext</tt><tt class="py-op">.</tt><tt class="py-name">verify_mode</tt> <tt class="py-op">=</tt> <tt class="py-name">ssl</tt><tt class="py-op">.</tt><tt class="py-name">CERT_NONE</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"sslContext"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">sslContext</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">            <tt id="link-56" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-56', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warn</tt><tt class="py-op">(</tt><tt class="py-string">"Turning off SSL certificate verification!"</tt><tt class="py-op">)</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">        <tt class="py-comment"># Check that a snapshot is configured for each machine</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">        <tt class="py-comment"># and that it was taken in a powered-on state</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">            <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-57" class="py-name" targets="Variable lib.cuckoo.core.database.Task.machine=lib.cuckoo.core.database.Task-class.html#machine"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-57', 'machine', 'link-57');">machine</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-58" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.machines()=lib.cuckoo.common.abstracts.Machinery-class.html#machines"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-58', 'machines', 'link-58');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-59" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-59', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.snapshot=lib.cuckoo.core.database.Machine-class.html#snapshot"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-60', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                        <tt class="py-keyword">raise</tt> <tt id="link-61" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-61', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">                            <tt class="py-string">"Snapshot name not specified for machine %s, "</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">                            <tt class="py-string">"please add it to the config file."</tt> <tt class="py-op">%</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">                            <tt id="link-62" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-62', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.label=lib.cuckoo.core.database.Guest-class.html#label,Variable lib.cuckoo.core.database.Machine.label=lib.cuckoo.core.database.Machine-class.html#label"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-63', 'label', 'link-63');">label</a></tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                        <tt class="py-op">)</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line"> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">                    <tt class="py-name">vm</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-64" class="py-name" targets="Method modules.machinery.vsphere.vSphere._get_virtual_machine_by_label()=modules.machinery.vsphere.vSphere-class.html#_get_virtual_machine_by_label"><a title="modules.machinery.vsphere.vSphere._get_virtual_machine_by_label" class="py-name" href="#" onclick="return doclink('link-64', '_get_virtual_machine_by_label', 'link-64');">_get_virtual_machine_by_label</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt id="link-65" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-65', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-66', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">vm</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">                        <tt class="py-keyword">raise</tt> <tt id="link-67" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-67', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">                            <tt class="py-string">"Unable to find machine %s on vSphere host, "</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">                            <tt class="py-string">"please update your configuration."</tt> <tt class="py-op">%</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">                            <tt id="link-68" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-68', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-69" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-69', 'label', 'link-63');">label</a></tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">                        <tt class="py-op">)</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line"> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">                    <tt class="py-name">state</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Method modules.machinery.vsphere.vSphere._get_snapshot_power_state()=modules.machinery.vsphere.vSphere-class.html#_get_snapshot_power_state"><a title="modules.machinery.vsphere.vSphere._get_snapshot_power_state" class="py-name" href="#" onclick="return doclink('link-70', '_get_snapshot_power_state', 'link-70');">_get_snapshot_power_state</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-71" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-71', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-72" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-72', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">)</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">state</tt><tt class="py-op">:</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                        <tt class="py-keyword">raise</tt> <tt id="link-73" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-73', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">                            <tt class="py-string">"Unable to find snapshot %s for machine %s, "</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">                            <tt class="py-string">"please update your configuration."</tt> <tt class="py-op">%</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">                            <tt class="py-op">(</tt><tt id="link-74" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-74', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-75', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">,</tt> <tt id="link-76" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-76', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-77" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-77', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">                        <tt class="py-op">)</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line"> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">state</tt> <tt class="py-op">!=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-78" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-78', 'RUNNING', 'link-24');">RUNNING</a></tt><tt class="py-op">:</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">                        <tt class="py-keyword">raise</tt> <tt id="link-79" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-79', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">                            <tt class="py-string">"Snapshot for machine %s not in powered-on "</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">                            <tt class="py-string">"state, please create one."</tt> <tt class="py-op">%</tt> <tt id="link-80" class="py-name"><a title="lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-80', 'machine', 'link-57');">machine</a></tt><tt class="py-op">.</tt><tt id="link-81" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-81', 'label', 'link-63');">label</a></tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">                        <tt class="py-op">)</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-82" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-82', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt class="py-name">e</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-83" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-83', 'CuckooCriticalError', 'link-19');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">                <tt class="py-string">"Couldn't connect to vSphere host: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">        <tt class="py-name">super</tt><tt class="py-op">(</tt><tt id="link-84" class="py-name"><a title="modules.machinery.vsphere.vSphere" class="py-name" href="#" onclick="return doclink('link-84', 'vSphere', 'link-30');">vSphere</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-85" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery._initialize_check()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#_initialize_check,Method lib.cuckoo.common.abstracts.Machinery._initialize_check()=lib.cuckoo.common.abstracts.Machinery-class.html#_initialize_check,Method modules.machinery.avd.Avd._initialize_check()=modules.machinery.avd.Avd-class.html#_initialize_check,Method modules.machinery.esx.ESX._initialize_check()=modules.machinery.esx.ESX-class.html#_initialize_check,Method modules.machinery.physical.Physical._initialize_check()=modules.machinery.physical.Physical-class.html#_initialize_check,Method modules.machinery.qemu.QEMU._initialize_check()=modules.machinery.qemu.QEMU-class.html#_initialize_check,Method modules.machinery.virtualbox.VirtualBox._initialize_check()=modules.machinery.virtualbox.VirtualBox-class.html#_initialize_check,Method modules.machinery.vmware.VMware._initialize_check()=modules.machinery.vmware.VMware-class.html#_initialize_check,Method modules.machinery.vsphere.vSphere._initialize_check()=modules.machinery.vsphere.vSphere-class.html#_initialize_check,Method modules.machinery.xenserver.XenServerMachinery._initialize_check()=modules.machinery.xenserver.XenServerMachinery-class.html#_initialize_check"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._initialize_check
lib.cuckoo.common.abstracts.Machinery._initialize_check
modules.machinery.avd.Avd._initialize_check
modules.machinery.esx.ESX._initialize_check
modules.machinery.physical.Physical._initialize_check
modules.machinery.qemu.QEMU._initialize_check
modules.machinery.virtualbox.VirtualBox._initialize_check
modules.machinery.vmware.VMware._initialize_check
modules.machinery.vsphere.vSphere._initialize_check
modules.machinery.xenserver.XenServerMachinery._initialize_check" class="py-name" href="#" onclick="return doclink('link-85', '_initialize_check', 'link-85');">_initialize_check</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line"> </tt>
<a name="vSphere.start"></a><div id="vSphere.start-def"><a name="L144"></a><tt class="py-lineno">144</tt> <a class="py-toggle" href="#" id="vSphere.start-toggle" onclick="return toggle('vSphere.start');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#start">start</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere.start-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere.start-expanded"><a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start a machine.</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: machine name.</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line"><tt class="py-docstring">        @param task: task object.</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to start machine.</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">        <tt id="link-86" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.name=lib.cuckoo.common.abstracts.Signature-class.html#name,Variable lib.cuckoo.core.database.Guest.name=lib.cuckoo.core.database.Guest-class.html#name,Variable lib.cuckoo.core.database.Machine.name=lib.cuckoo.core.database.Machine-class.html#name,Variable lib.cuckoo.core.database.Tag.name=lib.cuckoo.core.database.Tag-class.html#name,Variable modules.signatures.creates_exe.CreatesExe.name=modules.signatures.creates_exe.CreatesExe-class.html#name,Variable modules.signatures.generic_metrics.SystemMetrics.name=modules.signatures.generic_metrics.SystemMetrics-class.html#name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-86', 'name', 'link-86');">name</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-87" class="py-name" targets="Variable lib.cuckoo.core.guest.db=lib.cuckoo.core.guest-module.html#db,Variable modules.auxiliary.services.db=modules.auxiliary.services-module.html#db"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-87', 'db', 'link-87');">db</a></tt><tt class="py-op">.</tt><tt id="link-88" class="py-name" targets="Method lib.cuckoo.core.database.Database.view_machine_by_label()=lib.cuckoo.core.database.Database-class.html#view_machine_by_label"><a title="lib.cuckoo.core.database.Database.view_machine_by_label" class="py-name" href="#" onclick="return doclink('link-88', 'view_machine_by_label', 'link-88');">view_machine_by_label</a></tt><tt class="py-op">(</tt><tt id="link-89" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-89', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-90" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-90', 'snapshot', 'link-60');">snapshot</a></tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">            <tt class="py-name">vm</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_virtual_machine_by_label" class="py-name" href="#" onclick="return doclink('link-91', '_get_virtual_machine_by_label', 'link-64');">_get_virtual_machine_by_label</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt id="link-92" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-92', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">vm</tt><tt class="py-op">:</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-93" class="py-name" targets="Method modules.machinery.vsphere.vSphere._revert_snapshot()=modules.machinery.vsphere.vSphere-class.html#_revert_snapshot"><a title="modules.machinery.vsphere.vSphere._revert_snapshot" class="py-name" href="#" onclick="return doclink('link-93', '_revert_snapshot', 'link-93');">_revert_snapshot</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-94" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-94', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-95" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-95', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">                    <tt class="py-string">"Machine %s not found on host"</tt> <tt class="py-op">%</tt> <tt id="link-96" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-96', 'label', 'link-63');">label</a></tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
</div><a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line"> </tt>
<a name="vSphere.stop"></a><div id="vSphere.stop-def"><a name="L160"></a><tt class="py-lineno">160</tt> <a class="py-toggle" href="#" id="vSphere.stop-toggle" onclick="return toggle('vSphere.stop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#stop">stop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere.stop-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere.stop-expanded"><a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">        <tt class="py-docstring">"""Stop a machine.</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: machine name.</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to stop machine</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">            <tt class="py-name">vm</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-97" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_virtual_machine_by_label" class="py-name" href="#" onclick="return doclink('link-97', '_get_virtual_machine_by_label', 'link-64');">_get_virtual_machine_by_label</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt id="link-98" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-98', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">vm</tt><tt class="py-op">:</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-99" class="py-name" targets="Method modules.machinery.vsphere.vSphere._stop_virtual_machine()=modules.machinery.vsphere.vSphere-class.html#_stop_virtual_machine"><a title="modules.machinery.vsphere.vSphere._stop_virtual_machine" class="py-name" href="#" onclick="return doclink('link-99', '_stop_virtual_machine', 'link-99');">_stop_virtual_machine</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">)</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-100" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-100', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">                    <tt class="py-string">"Machine %s not found on host"</tt> <tt class="py-op">%</tt> <tt id="link-101" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-101', 'label', 'link-63');">label</a></tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
</div><a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line"> </tt>
<a name="vSphere.dump_memory"></a><div id="vSphere.dump_memory-def"><a name="L174"></a><tt class="py-lineno">174</tt> <a class="py-toggle" href="#" id="vSphere.dump_memory-toggle" onclick="return toggle('vSphere.dump_memory');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#dump_memory">dump_memory</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere.dump_memory-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere.dump_memory-expanded"><a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">        <tt class="py-docstring">"""Take a memory dump of a machine.</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line"><tt class="py-docstring">        @param path: path to where to store the memory dump</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if error taking the memory dump</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">        <tt id="link-102" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-102', 'name', 'link-86');">name</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"cuckoo_memdump_{0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">random</tt><tt class="py-op">.</tt><tt class="py-name">randint</tt><tt class="py-op">(</tt><tt class="py-number">100000</tt><tt class="py-op">,</tt> <tt class="py-number">999999</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">            <tt class="py-name">vm</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-103" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_virtual_machine_by_label" class="py-name" href="#" onclick="return doclink('link-103', '_get_virtual_machine_by_label', 'link-64');">_get_virtual_machine_by_label</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt id="link-104" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-104', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">vm</tt><tt class="py-op">:</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-105" class="py-name" targets="Method modules.machinery.vsphere.vSphere._create_snapshot()=modules.machinery.vsphere.vSphere-class.html#_create_snapshot"><a title="modules.machinery.vsphere.vSphere._create_snapshot" class="py-name" href="#" onclick="return doclink('link-105', '_create_snapshot', 'link-105');">_create_snapshot</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-106" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-106', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name" targets="Method modules.machinery.vsphere.vSphere._download_snapshot()=modules.machinery.vsphere.vSphere-class.html#_download_snapshot"><a title="modules.machinery.vsphere.vSphere._download_snapshot" class="py-name" href="#" onclick="return doclink('link-107', '_download_snapshot', 'link-107');">_download_snapshot</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-108" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-108', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-109" class="py-name" targets="Method modules.machinery.vsphere.vSphere._delete_snapshot()=modules.machinery.vsphere.vSphere-class.html#_delete_snapshot"><a title="modules.machinery.vsphere.vSphere._delete_snapshot" class="py-name" href="#" onclick="return doclink('link-109', '_delete_snapshot', 'link-109');">_delete_snapshot</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-110" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-110', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-111" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-111', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                    <tt class="py-string">"Machine %s not found on host"</tt> <tt class="py-op">%</tt> <tt id="link-112" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-112', 'label', 'link-63');">label</a></tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
</div><a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line"> </tt>
<a name="vSphere._list"></a><div id="vSphere._list-def"><a name="L191"></a><tt class="py-lineno">191</tt> <a class="py-toggle" href="#" id="vSphere._list-toggle" onclick="return toggle('vSphere._list');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_list">_list</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._list-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._list-expanded"><a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">        <tt class="py-docstring">"""List virtual machines on vSphere host"""</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">        <tt class="py-name">ret</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">vm</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-113" class="py-name" targets="Method modules.machinery.vsphere.vSphere._get_virtual_machines()=modules.machinery.vsphere.vSphere-class.html#_get_virtual_machines"><a title="modules.machinery.vsphere.vSphere._get_virtual_machines" class="py-name" href="#" onclick="return doclink('link-113', '_get_virtual_machines', 'link-113');">_get_virtual_machines</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">                <tt class="py-name">ret</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-114" class="py-name" targets="Module lib.cuckoo.common.config=lib.cuckoo.common.config-module.html"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-114', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-115" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-115', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">ret</tt> </tt>
</div><a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line"> </tt>
<a name="vSphere._status"></a><div id="vSphere._status-def"><a name="L199"></a><tt class="py-lineno">199</tt> <a class="py-toggle" href="#" id="vSphere._status-toggle" onclick="return toggle('vSphere._status');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_status">_status</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._status-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._status-expanded"><a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-docstring">"""Get power state of vm from vSphere host.</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: virtual machine name</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if error getting status or machine not found</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">SmartConnection</tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">conn</tt><tt class="py-op">:</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">            <tt class="py-name">vm</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-116" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_virtual_machine_by_label" class="py-name" href="#" onclick="return doclink('link-116', '_get_virtual_machine_by_label', 'link-64');">_get_virtual_machine_by_label</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt id="link-117" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-117', 'label', 'link-63');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">vm</tt><tt class="py-op">:</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-118" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-118', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">                    <tt class="py-string">"Machine %s not found on server"</tt> <tt class="py-op">%</tt> <tt id="link-119" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-119', 'label', 'link-63');">label</a></tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line"> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">            <tt id="link-120" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.status=lib.cuckoo.core.database.Guest-class.html#status,Variable lib.cuckoo.core.database.Machine.status=lib.cuckoo.core.database.Machine-class.html#status,Variable lib.cuckoo.core.database.Task.status=lib.cuckoo.core.database.Task-class.html#status"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-120', 'status', 'link-120');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">runtime</tt><tt class="py-op">.</tt><tt class="py-name">powerState</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-121" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.set_status()=lib.cuckoo.common.abstracts.Machinery-class.html#set_status,Method lib.cuckoo.core.database.Database.set_status()=lib.cuckoo.core.database.Database-class.html#set_status"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-121', 'set_status', 'link-121');">set_status</a></tt><tt class="py-op">(</tt><tt id="link-122" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-122', 'label', 'link-63');">label</a></tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-123', 'status', 'link-120');">status</a></tt><tt class="py-op">)</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt id="link-124" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-124', 'status', 'link-120');">status</a></tt> </tt>
</div><a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line"> </tt>
<a name="vSphere._get_virtual_machines"></a><div id="vSphere._get_virtual_machines-def"><a name="L215"></a><tt class="py-lineno">215</tt> <a class="py-toggle" href="#" id="vSphere._get_virtual_machines-toggle" onclick="return toggle('vSphere._get_virtual_machines');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_get_virtual_machines">_get_virtual_machines</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">conn</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._get_virtual_machines-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._get_virtual_machines-expanded"><a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">        <tt class="py-docstring">"""Iterate over all VirtualMachine managed objects on vSphere host"""</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">        <tt class="py-keyword">def</tt> <tt class="py-def-name">traverseDCFolders</tt><tt class="py-op">(</tt><tt class="py-param">conn</tt><tt class="py-op">,</tt> <tt class="py-param">nodes</tt><tt class="py-op">,</tt> <tt class="py-param">path</tt><tt class="py-op">=</tt><tt class="py-string">""</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">node</tt> <tt class="py-keyword">in</tt> <tt class="py-name">nodes</tt><tt class="py-op">:</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">,</tt> <tt class="py-string">"childEntity"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt class="py-name">child</tt><tt class="py-op">,</tt> <tt class="py-name">childpath</tt> <tt class="py-keyword">in</tt> <tt class="py-name">traverseDCFolders</tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt class="py-name">node</tt><tt class="py-op">.</tt><tt class="py-name">childEntity</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt> <tt class="py-op">+</tt> <tt class="py-name">node</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-125', 'name', 'link-86');">name</a></tt> <tt class="py-op">+</tt> <tt class="py-string">"/"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">                        <tt class="py-keyword">yield</tt> <tt class="py-name">child</tt><tt class="py-op">,</tt> <tt class="py-name">childpath</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt class="py-name">node</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt> <tt class="py-op">+</tt> <tt class="py-name">node</tt><tt class="py-op">.</tt><tt id="link-126" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-126', 'name', 'link-86');">name</a></tt> </tt>
</div><a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">        <tt class="py-keyword">def</tt> <tt class="py-def-name">traverseVMFolders</tt><tt class="py-op">(</tt><tt class="py-param">conn</tt><tt class="py-op">,</tt> <tt class="py-param">nodes</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">node</tt> <tt class="py-keyword">in</tt> <tt class="py-name">nodes</tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">,</tt> <tt class="py-string">"childEntity"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">                    <tt class="py-keyword">for</tt> <tt class="py-name">child</tt> <tt class="py-keyword">in</tt> <tt class="py-name">traverseVMFolders</tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt class="py-name">node</tt><tt class="py-op">.</tt><tt class="py-name">childEntity</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">                        <tt class="py-keyword">yield</tt> <tt class="py-name">child</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">                <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt class="py-name">node</tt> </tt>
</div><a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">VMtoDC</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line"> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">dc</tt><tt class="py-op">,</tt> <tt class="py-name">dcpath</tt> <tt class="py-keyword">in</tt> <tt class="py-name">traverseDCFolders</tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt class="py-name">conn</tt><tt class="py-op">.</tt><tt class="py-name">content</tt><tt class="py-op">.</tt><tt class="py-name">rootFolder</tt><tt class="py-op">.</tt><tt class="py-name">childEntity</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">vm</tt> <tt class="py-keyword">in</tt> <tt class="py-name">traverseVMFolders</tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">,</tt> <tt class="py-name">dc</tt><tt class="py-op">.</tt><tt class="py-name">vmFolder</tt><tt class="py-op">.</tt><tt class="py-name">childEntity</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">VMtoDC</tt><tt class="py-op">[</tt><tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-127" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-127', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-128" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-128', 'name', 'link-86');">name</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">dcpath</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">                <tt class="py-keyword">yield</tt> <tt class="py-name">vm</tt> </tt>
</div><a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line"> </tt>
<a name="vSphere._get_virtual_machine_by_label"></a><div id="vSphere._get_virtual_machine_by_label-def"><a name="L240"></a><tt class="py-lineno">240</tt> <a class="py-toggle" href="#" id="vSphere._get_virtual_machine_by_label-toggle" onclick="return toggle('vSphere._get_virtual_machine_by_label');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_get_virtual_machine_by_label">_get_virtual_machine_by_label</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">conn</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._get_virtual_machine_by_label-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._get_virtual_machine_by_label-expanded"><a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the named VirtualMachine managed object"""</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">vm</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_virtual_machines" class="py-name" href="#" onclick="return doclink('link-129', '_get_virtual_machines', 'link-113');">_get_virtual_machines</a></tt><tt class="py-op">(</tt><tt class="py-name">conn</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-130" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-130', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-131" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-131', 'name', 'link-86');">name</a></tt> <tt class="py-op">==</tt> <tt id="link-132" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-132', 'label', 'link-63');">label</a></tt><tt class="py-op">:</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">vm</tt> </tt>
</div><a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line"> </tt>
<a name="vSphere._get_snapshot_by_name"></a><div id="vSphere._get_snapshot_by_name-def"><a name="L246"></a><tt class="py-lineno">246</tt> <a class="py-toggle" href="#" id="vSphere._get_snapshot_by_name-toggle" onclick="return toggle('vSphere._get_snapshot_by_name');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_get_snapshot_by_name">_get_snapshot_by_name</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._get_snapshot_by_name-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._get_snapshot_by_name-expanded"><a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the named VirtualMachineSnapshot managed object for</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line"><tt class="py-docstring">        a virtual machine"""</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">ss</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-133" class="py-name" targets="Method modules.machinery.vsphere.vSphere._traverseSnapshots()=modules.machinery.vsphere.vSphere-class.html#_traverseSnapshots"><a title="modules.machinery.vsphere.vSphere._traverseSnapshots" class="py-name" href="#" onclick="return doclink('link-133', '_traverseSnapshots', 'link-133');">_traverseSnapshots</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">.</tt><tt id="link-134" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-134', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">.</tt><tt class="py-name">rootSnapshotList</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">ss</tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-135', 'name', 'link-86');">name</a></tt> <tt class="py-op">==</tt> <tt id="link-136" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-136', 'name', 'link-86');">name</a></tt><tt class="py-op">:</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">ss</tt><tt class="py-op">.</tt><tt id="link-137" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-137', 'snapshot', 'link-60');">snapshot</a></tt> </tt>
</div><a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line"> </tt>
<a name="vSphere._get_snapshot_power_state"></a><div id="vSphere._get_snapshot_power_state-def"><a name="L253"></a><tt class="py-lineno">253</tt> <a class="py-toggle" href="#" id="vSphere._get_snapshot_power_state-toggle" onclick="return toggle('vSphere._get_snapshot_power_state');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_get_snapshot_power_state">_get_snapshot_power_state</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._get_snapshot_power_state-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._get_snapshot_power_state-expanded"><a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">        <tt class="py-docstring">"""Return the power state for a named VirtualMachineSnapshot object"""</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">ss</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-138" class="py-name"><a title="modules.machinery.vsphere.vSphere._traverseSnapshots" class="py-name" href="#" onclick="return doclink('link-138', '_traverseSnapshots', 'link-133');">_traverseSnapshots</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">.</tt><tt id="link-139" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-139', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">.</tt><tt class="py-name">rootSnapshotList</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">ss</tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-140', 'name', 'link-86');">name</a></tt> <tt class="py-op">==</tt> <tt id="link-141" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-141', 'name', 'link-86');">name</a></tt><tt class="py-op">:</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">ss</tt><tt class="py-op">.</tt><tt class="py-name">state</tt> </tt>
</div><a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"> </tt>
<a name="vSphere._create_snapshot"></a><div id="vSphere._create_snapshot-def"><a name="L259"></a><tt class="py-lineno">259</tt> <a class="py-toggle" href="#" id="vSphere._create_snapshot-toggle" onclick="return toggle('vSphere._create_snapshot');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_create_snapshot">_create_snapshot</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._create_snapshot-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._create_snapshot-expanded"><a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">        <tt class="py-docstring">"""Create named snapshot of virtual machine"""</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">        <tt id="link-142" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-142', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">            <tt class="py-string">"Creating snapshot %s for machine %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">            <tt id="link-143" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-143', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-144" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-144', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-145" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-145', 'name', 'link-86');">name</a></tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">        <tt class="py-name">task</tt> <tt class="py-op">=</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">CreateSnapshot_Task</tt><tt class="py-op">(</tt><tt id="link-146" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-146', 'name', 'link-86');">name</a></tt><tt class="py-op">=</tt><tt id="link-147" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-147', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">                                      <tt id="link-148" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.description=lib.cuckoo.common.abstracts.Signature-class.html#description,Variable modules.signatures.creates_exe.CreatesExe.description=modules.signatures.creates_exe.CreatesExe-class.html#description,Variable modules.signatures.generic_metrics.SystemMetrics.description=modules.signatures.generic_metrics.SystemMetrics-class.html#description"><a title="lib.cuckoo.common.abstracts.Signature.description
modules.signatures.creates_exe.CreatesExe.description
modules.signatures.generic_metrics.SystemMetrics.description" class="py-name" href="#" onclick="return doclink('link-148', 'description', 'link-148');">description</a></tt><tt class="py-op">=</tt><tt class="py-string">"Created by Cuckoo sandbox"</tt><tt class="py-op">,</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">                                      <tt id="link-149" class="py-name" targets="Variable lib.cuckoo.core.database.Task.memory=lib.cuckoo.core.database.Task-class.html#memory,Method modules.processing.baseline.Baseline.memory()=modules.processing.baseline.Baseline-class.html#memory,Module modules.processing.memory=modules.processing.memory-module.html"><a title="lib.cuckoo.core.database.Task.memory
modules.processing.baseline.Baseline.memory
modules.processing.memory" class="py-name" href="#" onclick="return doclink('link-149', 'memory', 'link-149');">memory</a></tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">                                      <tt class="py-name">quiesce</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-150" class="py-name" targets="Method modules.machinery.vsphere.vSphere._wait_task()=modules.machinery.vsphere.vSphere-class.html#_wait_task"><a title="modules.machinery.vsphere.vSphere._wait_task" class="py-name" href="#" onclick="return doclink('link-150', '_wait_task', 'link-150');">_wait_task</a></tt><tt class="py-op">(</tt><tt class="py-name">task</tt><tt class="py-op">)</tt> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-151" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-151', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-152" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-152', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"CreateSnapshot: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
</div><a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line"> </tt>
<a name="vSphere._delete_snapshot"></a><div id="vSphere._delete_snapshot-def"><a name="L275"></a><tt class="py-lineno">275</tt> <a class="py-toggle" href="#" id="vSphere._delete_snapshot-toggle" onclick="return toggle('vSphere._delete_snapshot');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_delete_snapshot">_delete_snapshot</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._delete_snapshot-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._delete_snapshot-expanded"><a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">        <tt class="py-docstring">"""Remove named snapshot of virtual machine"""</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">        <tt id="link-153" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-153', 'snapshot', 'link-60');">snapshot</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-154" class="py-name" targets="Method modules.machinery.vsphere.vSphere._get_snapshot_by_name()=modules.machinery.vsphere.vSphere-class.html#_get_snapshot_by_name"><a title="modules.machinery.vsphere.vSphere._get_snapshot_by_name" class="py-name" href="#" onclick="return doclink('link-154', '_get_snapshot_by_name', 'link-154');">_get_snapshot_by_name</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-155" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-155', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-156" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-156', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">            <tt id="link-157" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-157', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">                <tt class="py-string">"Removing snapshot %s for machine %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">                <tt id="link-158" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-158', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-159', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-160" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-160', 'name', 'link-86');">name</a></tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line"> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">            <tt class="py-name">task</tt> <tt class="py-op">=</tt> <tt id="link-161" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-161', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">.</tt><tt class="py-name">RemoveSnapshot_Task</tt><tt class="py-op">(</tt><tt class="py-name">removeChildren</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="modules.machinery.vsphere.vSphere._wait_task" class="py-name" href="#" onclick="return doclink('link-162', '_wait_task', 'link-150');">_wait_task</a></tt><tt class="py-op">(</tt><tt class="py-name">task</tt><tt class="py-op">)</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt id="link-163" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-163', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">                <tt id="link-164" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-164', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"RemoveSnapshot: {0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-165" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-165', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">                <tt class="py-string">"Snapshot %s for machine %s not found"</tt> <tt class="py-op">%</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">                <tt class="py-op">(</tt><tt id="link-166" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-166', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-167" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-167', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-168" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-168', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
</div><a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line"> </tt>
<a name="vSphere._revert_snapshot"></a><div id="vSphere._revert_snapshot-def"><a name="L295"></a><tt class="py-lineno">295</tt> <a class="py-toggle" href="#" id="vSphere._revert_snapshot-toggle" onclick="return toggle('vSphere._revert_snapshot');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_revert_snapshot">_revert_snapshot</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._revert_snapshot-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._revert_snapshot-expanded"><a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">        <tt class="py-docstring">"""Revert virtual machine to named snapshot"""</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">        <tt id="link-169" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-169', 'snapshot', 'link-60');">snapshot</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-170" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_snapshot_by_name" class="py-name" href="#" onclick="return doclink('link-170', '_get_snapshot_by_name', 'link-154');">_get_snapshot_by_name</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-171" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-171', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-172" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-172', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">            <tt id="link-173" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-173', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">                <tt class="py-string">"Reverting machine %s to snapshot %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">                <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-174" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-174', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-175', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt id="link-176" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-176', 'name', 'link-86');">name</a></tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line"> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">            <tt class="py-name">task</tt> <tt class="py-op">=</tt> <tt id="link-177" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-177', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">.</tt><tt class="py-name">RevertToSnapshot_Task</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-178" class="py-name"><a title="modules.machinery.vsphere.vSphere._wait_task" class="py-name" href="#" onclick="return doclink('link-178', '_wait_task', 'link-150');">_wait_task</a></tt><tt class="py-op">(</tt><tt class="py-name">task</tt><tt class="py-op">)</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt id="link-179" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-179', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-180" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-180', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"RevertToSnapshot: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-181" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-181', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">                <tt class="py-string">"Snapshot %s for machine %s not found"</tt> <tt class="py-op">%</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">                <tt class="py-op">(</tt><tt id="link-182" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-182', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-183" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-183', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-184', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
</div><a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line"> </tt>
<a name="vSphere._download_snapshot"></a><div id="vSphere._download_snapshot-def"><a name="L315"></a><tt class="py-lineno">315</tt> <a class="py-toggle" href="#" id="vSphere._download_snapshot-toggle" onclick="return toggle('vSphere._download_snapshot');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_download_snapshot">_download_snapshot</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">conn</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">,</tt> <tt class="py-param">name</tt><tt class="py-op">,</tt> <tt class="py-param">path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._download_snapshot-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._download_snapshot-expanded"><a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">        <tt class="py-docstring">"""Download snapshot file from host to local path"""</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line"> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">        <tt class="py-comment"># Get filespec to .vmsn or .vmem file of named snapshot</tt> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">        <tt id="link-185" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-185', 'snapshot', 'link-60');">snapshot</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-186" class="py-name"><a title="modules.machinery.vsphere.vSphere._get_snapshot_by_name" class="py-name" href="#" onclick="return doclink('link-186', '_get_snapshot_by_name', 'link-154');">_get_snapshot_by_name</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">,</tt> <tt id="link-187" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-187', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-188" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-188', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-189" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-189', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">                <tt class="py-string">"Snapshot %s for machine %s not found"</tt> <tt class="py-op">%</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">                <tt class="py-op">(</tt><tt id="link-190" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-190', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-191" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-191', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-192" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-192', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line"> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line">        <tt class="py-name">memorykey</tt> <tt class="py-op">=</tt> <tt class="py-name">datakey</tt> <tt class="py-op">=</tt> <tt class="py-name">filespec</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">s</tt> <tt class="py-keyword">in</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">layoutEx</tt><tt class="py-op">.</tt><tt id="link-193" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-193', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">s</tt><tt class="py-op">.</tt><tt id="link-194" class="py-name" targets="Variable lib.cuckoo.common.abstracts.BehaviorHandler.key=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#key,Variable modules.processing.behavior.Anomaly.key=modules.processing.behavior.Anomaly-class.html#key,Variable modules.processing.behavior.ApiStats.key=modules.processing.behavior.ApiStats-class.html#key,Variable modules.processing.behavior.BehaviorAnalysis.key=modules.processing.behavior.BehaviorAnalysis-class.html#key,Variable modules.processing.behavior.GenericBehavior.key=modules.processing.behavior.GenericBehavior-class.html#key,Variable modules.processing.behavior.ProcessTree.key=modules.processing.behavior.ProcessTree-class.html#key,Variable modules.processing.behavior.Summary.key=modules.processing.behavior.Summary-class.html#key,Variable modules.processing.dumptls.TLSMasterSecrets.key=modules.processing.dumptls.TLSMasterSecrets-class.html#key,Variable modules.processing.network.NetworkAnalysis.key=modules.processing.network.NetworkAnalysis-class.html#key,Variable modules.processing.platform.linux.LinuxSystemTap.key=modules.processing.platform.linux.LinuxSystemTap-class.html#key,Variable modules.processing.platform.windows.WindowsMonitor.key=modules.processing.platform.windows.WindowsMonitor-class.html#key,Variable modules.processing.procmon.Procmon.key=modules.processing.procmon.Procmon-class.html#key"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key
modules.processing.procmon.Procmon.key" class="py-name" href="#" onclick="return doclink('link-194', 'key', 'link-194');">key</a></tt> <tt class="py-op">==</tt> <tt id="link-195" class="py-name"><a title="lib.cuckoo.core.database.Machine.snapshot" class="py-name" href="#" onclick="return doclink('link-195', 'snapshot', 'link-60');">snapshot</a></tt><tt class="py-op">:</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">                <tt class="py-name">memorykey</tt> <tt class="py-op">=</tt> <tt class="py-name">s</tt><tt class="py-op">.</tt><tt class="py-name">memoryKey</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">                <tt class="py-name">datakey</tt> <tt class="py-op">=</tt> <tt class="py-name">s</tt><tt class="py-op">.</tt><tt class="py-name">dataKey</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line"> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">f</tt> <tt class="py-keyword">in</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">layoutEx</tt><tt class="py-op">.</tt><tt class="py-name">file</tt><tt class="py-op">:</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-196" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key
modules.processing.procmon.Procmon.key" class="py-name" href="#" onclick="return doclink('link-196', 'key', 'link-194');">key</a></tt> <tt class="py-op">==</tt> <tt class="py-name">memorykey</tt> <tt class="py-keyword">and</tt> <tt class="py-op">(</tt><tt class="py-name">f</tt><tt class="py-op">.</tt><tt class="py-name">type</tt> <tt class="py-op">==</tt> <tt class="py-string">"snapshotMemory"</tt> <tt class="py-keyword">or</tt> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">                                       <tt class="py-name">f</tt><tt class="py-op">.</tt><tt class="py-name">type</tt> <tt class="py-op">==</tt> <tt class="py-string">"suspendMemory"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">                <tt class="py-name">filespec</tt> <tt class="py-op">=</tt> <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-197" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-197', 'name', 'link-86');">name</a></tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line"> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">filespec</tt><tt class="py-op">:</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">f</tt> <tt class="py-keyword">in</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">layoutEx</tt><tt class="py-op">.</tt><tt class="py-name">file</tt><tt class="py-op">:</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-198" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key
modules.processing.procmon.Procmon.key" class="py-name" href="#" onclick="return doclink('link-198', 'key', 'link-194');">key</a></tt> <tt class="py-op">==</tt> <tt class="py-name">datakey</tt> <tt class="py-keyword">and</tt> <tt class="py-name">f</tt><tt class="py-op">.</tt><tt class="py-name">type</tt> <tt class="py-op">==</tt> <tt class="py-string">"snapshotData"</tt><tt class="py-op">:</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">                    <tt class="py-name">filespec</tt> <tt class="py-op">=</tt> <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-199', 'name', 'link-86');">name</a></tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">                    <tt class="py-keyword">break</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line"> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">filespec</tt><tt class="py-op">:</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-200" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-200', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Could not find snapshot memory file"</tt><tt class="py-op">)</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line"> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line">        <tt id="link-201" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-201', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Downloading memory dump %s to %s"</tt><tt class="py-op">,</tt> <tt class="py-name">filespec</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line"> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">        <tt class="py-comment"># Parse filespec to get datastore and file path.</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">        <tt class="py-name">datastore</tt><tt class="py-op">,</tt> <tt class="py-name">filepath</tt> <tt class="py-op">=</tt> <tt class="py-name">re</tt><tt class="py-op">.</tt><tt class="py-name">match</tt><tt class="py-op">(</tt><tt class="py-string">r"\[([^\]]*)\] (.*)"</tt><tt class="py-op">,</tt> <tt class="py-name">filespec</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">groups</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line"> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">        <tt class="py-comment"># Construct URL request</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">        <tt class="py-name">params</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">            <tt class="py-string">"dsName"</tt><tt class="py-op">:</tt> <tt class="py-name">datastore</tt><tt class="py-op">,</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">            <tt class="py-string">"dcPath"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">VMtoDC</tt><tt class="py-op">.</tt><tt id="link-202" class="py-name" targets="Method lib.cuckoo.common.config.Config.get()=lib.cuckoo.common.config.Config-class.html#get,Method lib.cuckoo.core.guest.GuestManager.get()=lib.cuckoo.core.guest.GuestManager-class.html#get"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-202', 'get', 'link-202');">get</a></tt><tt class="py-op">(</tt><tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-203" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-203', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-204', 'name', 'link-86');">name</a></tt><tt class="py-op">,</tt> <tt class="py-string">"ha-datacenter"</tt><tt class="py-op">)</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">        <tt class="py-op">}</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">        <tt class="py-name">headers</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">            <tt class="py-string">"Cookie"</tt><tt class="py-op">:</tt> <tt class="py-name">conn</tt><tt class="py-op">.</tt><tt class="py-name">_stub</tt><tt class="py-op">.</tt><tt class="py-name">cookie</tt><tt class="py-op">,</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">        <tt class="py-op">}</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">        <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"https://%s:%s/folder/%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"host"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">connect_opts</tt><tt class="py-op">[</tt><tt class="py-string">"port"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">filepath</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line"> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">        <tt class="py-comment"># Stream download to specified local path</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">            <tt class="py-name">response</tt> <tt class="py-op">=</tt> <tt class="py-name">requests</tt><tt class="py-op">.</tt><tt id="link-205" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-205', 'get', 'link-202');">get</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">params</tt><tt class="py-op">=</tt><tt class="py-name">params</tt><tt class="py-op">,</tt> <tt class="py-name">headers</tt><tt class="py-op">=</tt><tt class="py-name">headers</tt><tt class="py-op">,</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">                                    <tt class="py-name">verify</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt> <tt class="py-name">stream</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line"> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">            <tt class="py-name">response</tt><tt class="py-op">.</tt><tt class="py-name">raise_for_status</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line"> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">            <tt class="py-keyword">with</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-string">"wb"</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">localfile</tt><tt class="py-op">:</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">chunk</tt> <tt class="py-keyword">in</tt> <tt class="py-name">response</tt><tt class="py-op">.</tt><tt class="py-name">iter_content</tt><tt class="py-op">(</tt><tt class="py-number">16</tt><tt class="py-op">*</tt><tt class="py-number">1024</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">                    <tt class="py-name">localfile</tt><tt class="py-op">.</tt><tt id="link-206" class="py-name" targets="Method modules.processing.network.SortCap.write()=modules.processing.network.SortCap-class.html#write"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-206', 'write', 'link-206');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">chunk</tt><tt class="py-op">)</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line"> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-207" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-207', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">                <tt class="py-string">"Error downloading memory dump %s: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">                <tt class="py-op">(</tt><tt class="py-name">filespec</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
</div><a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line"> </tt>
<a name="vSphere._stop_virtual_machine"></a><div id="vSphere._stop_virtual_machine-def"><a name="L382"></a><tt class="py-lineno">382</tt> <a class="py-toggle" href="#" id="vSphere._stop_virtual_machine-toggle" onclick="return toggle('vSphere._stop_virtual_machine');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_stop_virtual_machine">_stop_virtual_machine</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._stop_virtual_machine-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._stop_virtual_machine-expanded"><a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">        <tt class="py-docstring">"""Power off a virtual machine"""</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">        <tt id="link-208" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-208', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Powering off virtual machine %s"</tt><tt class="py-op">,</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">summary</tt><tt class="py-op">.</tt><tt id="link-209" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-209', 'config', 'link-114');">config</a></tt><tt class="py-op">.</tt><tt id="link-210" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-210', 'name', 'link-86');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">        <tt class="py-name">task</tt> <tt class="py-op">=</tt> <tt class="py-name">vm</tt><tt class="py-op">.</tt><tt class="py-name">PowerOffVM_Task</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-211" class="py-name"><a title="modules.machinery.vsphere.vSphere._wait_task" class="py-name" href="#" onclick="return doclink('link-211', '_wait_task', 'link-150');">_wait_task</a></tt><tt class="py-op">(</tt><tt class="py-name">task</tt><tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-212" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-212', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">            <tt id="link-213" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.common.utils.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.reboot.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.debug.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.irma.log
modules.processing.memory.log
modules.processing.misp.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.procmemory.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.elasticsearch.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-213', 'log', 'link-23');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"PowerOffVM: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
</div><a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line"> </tt>
<a name="vSphere._wait_task"></a><div id="vSphere._wait_task-def"><a name="L391"></a><tt class="py-lineno">391</tt> <a class="py-toggle" href="#" id="vSphere._wait_task-toggle" onclick="return toggle('vSphere._wait_task');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_wait_task">_wait_task</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._wait_task-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._wait_task-expanded"><a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">        <tt class="py-docstring">"""Wait for a task to complete with timeout"""</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">        <tt class="py-name">limit</tt> <tt class="py-op">=</tt> <tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">timedelta</tt><tt class="py-op">(</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">            <tt class="py-name">seconds</tt><tt class="py-op">=</tt><tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">options_globals</tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt class="py-name">vm_state</tt><tt class="py-op">)</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">        <tt id="link-214" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.start()=lib.cuckoo.common.abstracts.Auxiliary-class.html#start,Method lib.cuckoo.common.abstracts.LibVirtMachinery.start()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#start,Method lib.cuckoo.common.abstracts.Machinery.start()=lib.cuckoo.common.abstracts.Machinery-class.html#start,Method lib.cuckoo.core.plugins.RunAuxiliary.start()=lib.cuckoo.core.plugins.RunAuxiliary-class.html#start,Method lib.cuckoo.core.scheduler.Scheduler.start()=lib.cuckoo.core.scheduler.Scheduler-class.html#start,Method modules.auxiliary.mitm.MITM.start()=modules.auxiliary.mitm.MITM-class.html#start,Method modules.auxiliary.reboot.Reboot.start()=modules.auxiliary.reboot.Reboot-class.html#start,Method modules.auxiliary.services.Services.start()=modules.auxiliary.services.Services-class.html#start,Method modules.auxiliary.sniffer.Sniffer.start()=modules.auxiliary.sniffer.Sniffer-class.html#start,Method modules.machinery.avd.Avd.start()=modules.machinery.avd.Avd-class.html#start,Method modules.machinery.physical.Physical.start()=modules.machinery.physical.Physical-class.html#start,Method modules.machinery.qemu.QEMU.start()=modules.machinery.qemu.QEMU-class.html#start,Method modules.machinery.virtualbox.VirtualBox.start()=modules.machinery.virtualbox.VirtualBox-class.html#start,Method modules.machinery.vmware.VMware.start()=modules.machinery.vmware.VMware-class.html#start,Method modules.machinery.vsphere.vSphere.start()=modules.machinery.vsphere.vSphere-class.html#start,Method modules.machinery.xenserver.XenServerMachinery.start()=modules.machinery.xenserver.XenServerMachinery-class.html#start"><a title="lib.cuckoo.common.abstracts.Auxiliary.start
lib.cuckoo.common.abstracts.LibVirtMachinery.start
lib.cuckoo.common.abstracts.Machinery.start
lib.cuckoo.core.plugins.RunAuxiliary.start
lib.cuckoo.core.scheduler.Scheduler.start
modules.auxiliary.mitm.MITM.start
modules.auxiliary.reboot.Reboot.start
modules.auxiliary.services.Services.start
modules.auxiliary.sniffer.Sniffer.start
modules.machinery.avd.Avd.start
modules.machinery.physical.Physical.start
modules.machinery.qemu.QEMU.start
modules.machinery.virtualbox.VirtualBox.start
modules.machinery.vmware.VMware.start
modules.machinery.vsphere.vSphere.start
modules.machinery.xenserver.XenServerMachinery.start" class="py-name" href="#" onclick="return doclink('link-214', 'start', 'link-214');">start</a></tt> <tt class="py-op">=</tt> <tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">utcnow</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line"> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt class="py-name">True</tt><tt class="py-op">:</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">task</tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">.</tt><tt class="py-name">state</tt> <tt class="py-op">==</tt> <tt class="py-string">"error"</tt><tt class="py-op">:</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-215" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-215', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Task error"</tt><tt class="py-op">)</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line"> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">task</tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">.</tt><tt class="py-name">state</tt> <tt class="py-op">==</tt> <tt class="py-string">"success"</tt><tt class="py-op">:</tt> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line"> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">utcnow</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt id="link-216" class="py-name"><a title="lib.cuckoo.common.abstracts.Auxiliary.start
lib.cuckoo.common.abstracts.LibVirtMachinery.start
lib.cuckoo.common.abstracts.Machinery.start
lib.cuckoo.core.plugins.RunAuxiliary.start
lib.cuckoo.core.scheduler.Scheduler.start
modules.auxiliary.mitm.MITM.start
modules.auxiliary.reboot.Reboot.start
modules.auxiliary.services.Services.start
modules.auxiliary.sniffer.Sniffer.start
modules.machinery.avd.Avd.start
modules.machinery.physical.Physical.start
modules.machinery.qemu.QEMU.start
modules.machinery.virtualbox.VirtualBox.start
modules.machinery.vmware.VMware.start
modules.machinery.vsphere.vSphere.start
modules.machinery.xenserver.XenServerMachinery.start" class="py-name" href="#" onclick="return doclink('link-216', 'start', 'link-214');">start</a></tt> <tt class="py-op">&gt;</tt> <tt class="py-name">limit</tt><tt class="py-op">:</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-217" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-217', 'CuckooMachineError', 'link-9');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Task timed out"</tt><tt class="py-op">)</tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line"> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
</div><a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line"> </tt>
<a name="vSphere._traverseSnapshots"></a><div id="vSphere._traverseSnapshots-def"><a name="L410"></a><tt class="py-lineno">410</tt> <a class="py-toggle" href="#" id="vSphere._traverseSnapshots-toggle" onclick="return toggle('vSphere._traverseSnapshots');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.vsphere.vSphere-class.html#_traverseSnapshots">_traverseSnapshots</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="vSphere._traverseSnapshots-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="vSphere._traverseSnapshots-expanded"><a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">        <tt class="py-docstring">"""Recursive depth-first traversal of snapshot tree"""</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">node</tt> <tt class="py-keyword">in</tt> <tt class="py-name">root</tt><tt class="py-op">:</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">.</tt><tt class="py-name">childSnapshotList</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">child</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-218" class="py-name"><a title="modules.machinery.vsphere.vSphere._traverseSnapshots" class="py-name" href="#" onclick="return doclink('link-218', '_traverseSnapshots', 'link-133');">_traverseSnapshots</a></tt><tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">.</tt><tt class="py-name">childSnapshotList</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">                    <tt class="py-keyword">yield</tt> <tt class="py-name">child</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">            <tt class="py-keyword">yield</tt> <tt class="py-name">node</tt> </tt>
</div></div><a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Nov  4 23:21:59 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
